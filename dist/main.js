(()=>{var e,t={112:(e,t,i)=>{"use strict";i.d(t,{x:()=>r});class r{static Peers=new Array;static allAudioTracks=new Array;static mainAudioTrack;static silenceAudioTrack;static socketclient;static socketid;static localmediastream;static localMediaVideoStream;static localMediaAudioStream;static localVisualMedia;static capturestream=null;static AudioMix=new Event("onAudioMix");static conferencename;static userid;static isadmin;static displayname;static data;static getdata(){return this.data={conferencename:this.conferencename,userid:this.userid,isadmin:this.isadmin,displayname:this.displayname}}static videoInput=new Array;static audioInput=new Array;static audioOutput=new Array;static Constraints={audio:!1,video:!1};static isCameraAvailable=!1;static isMicAvailable=!1}},126:(e,t,i)=>{"use strict";function r(e){this.turn="turn:"+window.location.hostname+":3479",this.configuration={iceServers:[{urls:this.turn,credential:"test123",username:"test"}]},this.peer=new RTCPeerConnection(this.configuration),this.peerid=e,this.socketid,this.audiotrack,this.videotrack,this.videomediastream,this.audiomediastream,this.displayname,this.VisualMedia,this.showonstream}i.d(t,{_:()=>r})},94:(e,t,i)=>{"use strict";i.d(t,{N:()=>c,T:()=>d});var r,a,o=i(126),n=i(112),s=0;function c(){(a=n.x.getdata()).peerid=n.x.socketclient.id,r?r.peer.close():(r=new o._(a.peerid),n.x.capturestream||(n.x.capturestream=document.getElementById("MainCanvas").captureStream(30)),n.x.capturestream.addTrack(n.x.mainAudioTrack),n.x.capturestream.getTracks().forEach((e=>{console.log(e.getSettings()),console.log(e.getCapabilities()),console.log(e.getConstraints()),r.peer.addTrack(e,n.x.capturestream)})),r.peer.createOffer().then((e=>r.peer.setLocalDescription(e))).catch(l),r.peer.oniceconnectionstatechange=e=>console.log(r.peer.iceConnectionState),r.peer.onicecandidate=e=>{if(1==(s+=1)){let e=btoa(JSON.stringify(r.peer.localDescription));a.offer=e,n.x.socketclient.emit("sendofferforstreaming",a)}},n.x.socketclient.on("receiveanswerforstreaming",(function(e){try{r.peer.setRemoteDescription(new RTCSessionDescription(JSON.parse(atob(e)))),console.log("Streaming started . . ."),setTimeout((()=>{a.isadmin&&(notification("Started to record..","success"),$("#conferencetimer").addClass("recordblink"),$("#conferencetimer").addClass("RecordTextAdding"),$("#clockdiv .RecordText").append('<p id="recordingText" style="color: #100146; font-size: 12px; font-weight: bold;">Recording</p>'))}),6e3)}catch(e){console.log(e)}})))}function d(){a&&(a.channelLink=window.location.href.split("?")[0]+"recordedvideos/"+a.conferencename+"/",console.log("ObjVideoLink",a.channelLink),n.x.socketclient.emit("stopstreaming",a),setTimeout((()=>{r&&r.peer.close(),r=null}),3e3),notification("Recording stopped.","success"))}function l(e){}window.addEventListener("onAudioMix",(e=>{!function(){if(r){let e=r.peer.getSenders().find((function(e){return"audio"==e.track.kind}));e&&e.replaceTrack(n.x.mainAudioTrack)}}()}))},593:(e,t,i)=>{"use strict";i.d(t,{E:()=>ve});var r=i(112),a=i(126);function o(){this.ResizeImage=(e,t,i)=>{var r=document.createElement("canvas"),a=r.getContext("2d");return r.width=t,r.height=i,a.drawImage(e,0,0,t,i),r.toDataURL()},this.getRandom=function(e){return e[Math.floor(Math.random()*e.length)]},this.measureTextWidth=(e,t)=>(w.dummycanvasctx.font=t,w.dummycanvasctx.measureText(e).width),this.measureTextHeight=e=>(w.dummycanvasctx.font=e,parseInt(w.dummycanvasctx.font.match(/\d+/),15)),this.listenChangesinArray=function(e,t){["pop"].forEach((i=>{e[i]=function(){var r=Array.prototype[i].apply(e,arguments);return t.apply(e,arguments),r}}))},this.getPercentageValue=function(e,t){return t*(e/100)},this.getSizeMaintainingAspect=function(e,t,i,r){var a=Math.min(i/e,r/t);return{width:e*a,height:t*a}}}class n{constructor(){this.objUtil=new o}createCanvasTag(e,t=1280,i=720,r){const a=document.createElement("CANVAS");return a.width=t,a.height=i,a.style.width="1px",a.style.height="1px",a.id=e,r&&jQuery("#Main").append(a),a}parseColor(e){const t=document.createElement("div");document.body.appendChild(t),t.style.color=e;const i=getComputedStyle(t).color.match(/[\.\d]+/g).map(Number);return t.remove(),i}async createVideoTag(e,t=0,i=0){var r=document.createElement("VIDEO");return r.width=t,r.height=i,r.src=e,await r.setAttribute("src",e),r.setAttribute("autoplay","autoplay"),r.setAttribute("loop","loop"),r.setAttribute("controls",""),r.setAttribute("playsinline",""),r.muted=!0,await r.load(),await r.play(),r}async createAudioTag(e,t){var i=document.createElement("AUDIO");return i.id="audio_"+e,i.autoplay=!0,"object"==typeof t?await this.setSource(i,t):(i.src=t,await i.setAttribute("src",t)),document.body.appendChild(i),i}async createImageTag(e,t=null,i=null){const r=document.createElement("img");return r.src=e,await r.decode(),null!=i&&null!=t&&(r.src=this.objUtil.ResizeImage(r,t,i)),r}createDivTag(e){var t=document.createElement("DIV");return t.id=e,t}async createMediaTag(e,t,i,r,a=0,o=0,n){let s=document.createElement("VIDEO");if("object"==typeof i?await this.setSource(s,i):(s.src=i,await s.setAttribute("src",i)),s.setAttribute("autoplay","autoplay"),s.setAttribute("loop","loop"),s.classList.add("mirroron","videoBox"),s.setAttribute("id",t+"_"+r),s.setAttribute("playsinline",""),s.load(),"localstream"==t)var c='<div class="MainVideoBG" id="mainVideoBg"><div  class="mainVideo main-videoWrap" id="cardvideo_'+t+"_"+r+'"><div  class="main-Card card-img-overlay p-0  m-3"><span class="text-capitalize user-name" ><i class="icon-user pe-1"></i>'+n+'</span><div id="dropDown" class="dropdown float-end"><button class="btn btn-sm red-color dropdown-toggle" type="button" id="UserMenu" data-bs-toggle="dropdown"  aria-expanded="false" style="font-size: 1.5rem;"><i class="icon-dot"></i></button><ul id="Drop" class="dropdown-menu dropdown-menu-end" aria-labelledby="userMenu"><li onclick=toggleAudio(this,"'+r+'") ><a id="Dropdown_items" class="dropdown-item" href="#"><i class="bi bi-mic-mute m-1"></i>Start Audio</a></li><li onclick=toggleVideo(this,"'+r+'")><a id="Dropdown_items" class="dropdown-item" href="#"><i class="bi bi-camera-video-off m-1"></i>Stop Video</a></li><li onclick=toggleFlip(this,"'+r+'")><a id="Dropdown_items"  class="dropdown-item" href="#"><i class="bi bi-symmetry-vertical m-1"></i>Flip</a></li></ul></div></div></div></div>';else c=e?' <div id="ListVideos" class="video-list d-inline mb-lg-0 mb-3"><div class="SupportClass position-relative videoWrap m-2" id="cardvideo_'+t+"_"+r+'"><div class="cardList card-img-overlay p-0"><span class="text-capitalize user-name text-break"><i class="icon-user"></i>'+n+'</span> <div id="DropDown" class="dropdown  position-absolute top-0 end-0 m-2">  <button class="btn btn-sm red-color dropdown-toggle text-break" type="button" id="UserMenu" data-bs-toggle="dropdown"  aria-expanded="false" style="font-size: 1.5rem;" >   <i class="icon-dot"></i></button><ul id="Drop" class="dropdown-menu dropdown-menu-end" aria-labelledby="userMenu"><li onclick=toggleAudio(this,"'+r+'") ><a id="Dropdown_items" class="dropdown-item" href="#"><i class="bi bi-mic-mute m-1"></i>Start Audio</a></li><li onclick=toggleVideo(this,"'+r+'")><a id="Dropdown_items" class="dropdown-item" href="#"><i class="bi bi-camera-video-off m-1"></i>Stop Video</a></li></ul></div></div></div></div>':'<div  id="ListVideos" class="video-list d-inline  mb-lg-0 mb-3 "><div class="SupportClass position-relative videoWrap m-2" id="cardvideo_'+t+"_"+r+'"><div class="cardList card-img-overlay p-0"><span class="text-capitalize user-name text-break"><i class="icon-users"></i>'+n+"</span></div></div></div>";return $((function(){$("#ListVideos .videoWrap").draggable({containment:"document",drag:function(){$(this).addClass("pe-none")},stop:function(e,t){$(this).removeClass("pe-none")}})})),$("#ListVideos .videoWrap").length>0&&"undefined"!=$("#ListVideos .videoWrap").attr("style")&&$("#ListVideos .videoWrap").removeAttr("style"),$("#VisualMedia").append(c),jQuery("#cardvideo_"+t+"_"+r).prepend(s),await s.load(),await s.play(),s}async setSource(e,t){e.srcObject=t}}class s{constructor(e){this.name=e,this.divTag=this.createTag(e)}writeLogs(e,t=this.name){document.getElementById(t)?document.getElementById(t).innerHTML=e:this.createTag(t),document.getElementById(t).innerHTML=e}createTag(e){let t=(new n).createDivTag(e);return t.Id=e,document.body.appendChild(t),t}}function c(e,t=null){this.scene=e,this.objParent=t||null,this.EffectsInit=e=>{e.forEach((e=>{e.effects&&e.effects.forEach((t=>{e.CopyTargetsFromEffect(t),t.InitStart()})),e.overlays&&e.overlays.length>0&&this.EffectsInit(e.overlays)}))},this.SetOverlayAlignment=(t,i=this.objParent)=>{switch(t.left_or_right){case"left":t.x.relative=i?i.x.current+t.x.initial:this.scene.defaultx+t.x.initial;break;case"right":t.x.relative=i?i.x.current+i.w.current-t.x.initial:e.getFrameEndx()-t.w.target-t.x.initial;break;default:throw"Error, Overlay left or right alignment not specified."}switch(t.top_or_bottom){case"top":t.y.relative=i?i.y.current+t.y.initial:this.scene.defaulty+t.y.initial;break;case"bottom":t.y.relative=i?i.y.current+i.h.current-t.h.current-t.y.initial:this.scene.getFrameEndy()-t.h.current-t.y.initial;break;default:throw"Error!! Overlay top or bottom alignment not specified"}},this.EffectsBeforeDraw=(e,t=this.objParent)=>{e.forEach((e=>{var i;this.SetOverlayAlignment(e,t),e.RecalculatePosition(),1!=void((i=e.effects)&&i.length>0&&i.forEach((e=>{if("movencropfx"==e.type)return!0})))&&e.ApplyTargets(),e.ApplyEffects(),e.effects&&e.effects.forEach((e=>{e.beforeDraw()})),e.overlays&&e.overlays.length>0&&this.EffectsBeforeDraw(e.overlays,e)}))},Array.prototype.remove=function(e){return-1!=this.indexOf(e)&&(this.splice(this.indexOf(e),1),!0)},this.EffectsAfterDraw=e=>{e.forEach((t=>{t.effects&&t.effects.forEach((i=>{i.afterDraw(),1==i.completed&&(i.removefromscene&&e.splice(e.indexOf(t),1),t.effects.remove(i))})),t.overlays&&t.overlays.length>0&&this.EffectsAfterDraw(t.overlays)}))}}var d={},l=new function(){this.EffectsInit=e=>{e.backgroundeffects.forEach((e=>{0==e.initdone&&(e.InitStart(),e.initdone=!0)}))},this.EffectsBeforeDraw=e=>{e.backgroundeffects.forEach((t=>{"colorFadefx"==t.type&&(e.backcolor=t.backcolor.toRGBAString("current")),t.beforeDraw()}))},this.EffectsAfterDraw=e=>{e.backgroundeffects.forEach((t=>{t.afterDraw(),1==t.completed&&(t.initdone=!1,1==t.removefromscene&&(e.backgroundimg=""),e.backgroundeffects.splice(e.backgroundeffects.indexOf(t),1))}))}};var h={},u=!1,p={},m=!1;var g={},f=!1;const v=(f||(f=!0,y=g,x=function(e,t){var i,r=null,a=(i=t.load,function(){if(null!==r)return r;var e=new Blob(['(()=>{var e={67:(e,t,r)=>{var o,i;void 0===(i="function"==typeof(o=function(){"use strict";var e=new Map,t=new Map,r=function(t){var r=e.get(t);if(void 0===r)throw new Error(\'There is no interval scheduled with the given id "\'.concat(t,\'".\'));clearTimeout(r),e.delete(t)},o=function(e){var r=t.get(e);if(void 0===r)throw new Error(\'There is no timeout scheduled with the given id "\'.concat(e,\'".\'));clearTimeout(r),t.delete(e)},i=function(e,t){var r,o=performance.now();return{expected:o+(r=e-Math.max(0,o-t)),remainingDelay:r}},n=function e(t,r,o,i){var n=performance.now();n>o?postMessage({id:null,method:"call",params:{timerId:r,timerType:i}}):t.set(r,setTimeout(e,o-n,t,r,o,i))},a=function(t,r,o){var a=i(t,o),s=a.expected,d=a.remainingDelay;e.set(r,setTimeout(n,d,e,r,s,"interval"))},s=function(e,r,o){var a=i(e,o),s=a.expected,d=a.remainingDelay;t.set(r,setTimeout(n,d,t,r,s,"timeout"))};addEventListener("message",(function(e){var t=e.data;try{if("clear"===t.method){var i=t.id,n=t.params,d=n.timerId,c=n.timerType;if("interval"===c)r(d),postMessage({error:null,id:i});else{if("timeout"!==c)throw new Error(\'The given type "\'.concat(c,\'" is not supported\'));o(d),postMessage({error:null,id:i})}}else{if("set"!==t.method)throw new Error(\'The given method "\'.concat(t.method,\'" is not supported\'));var u=t.params,l=u.delay,p=u.now,m=u.timerId,v=u.timerType;if("interval"===v)a(l,m,p);else{if("timeout"!==v)throw new Error(\'The given type "\'.concat(v,\'" is not supported\'));s(l,m,p)}}}catch(e){postMessage({error:{message:e.message},id:t.id,result:null})}}))})?o.call(t,r,t,e):o)||(e.exports=i)}},t={};function r(o){var i=t[o];if(void 0!==i)return i.exports;var n=t[o]={exports:{}};return e[o](n,n.exports,r),n.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var o in t)r.o(t,o)&&!r.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";r(67)})()})();'],{type:"application/javascript; charset=utf-8"}),t=URL.createObjectURL(e);return(r=i(t)).setTimeout((function(){return URL.revokeObjectURL(t)}),0),r});e.clearInterval=function(e){return a().clearInterval(e)},e.clearTimeout=function(e){return a().clearTimeout(e)},e.setInterval=function(e,t){return a().setInterval(e,t)},e.setTimeout=function(e,t){return a().setTimeout(e,t)},Object.defineProperty(e,"__esModule",{value:!0})},"object"==typeof g?x(g,function(){return m||(m=!0,e=p,t=function(e,t){e.load=function(e){var i=new Map([[0,function(){}]]),r=new Map([[0,function(){}]]),a=new Map,o=new Worker(e);return o.addEventListener("message",(function(e){var t=e.data;if(function(e){return void 0!==e.method&&"call"===e.method}(t)){var o=t.params,n=o.timerId,s=o.timerType;if("interval"===s){var c=i.get(n);if("number"==typeof c){var d=a.get(c);if(void 0===d||d.timerId!==n||d.timerType!==s)throw new Error("The timer is in an undefined state.")}else{if(void 0===c)throw new Error("The timer is in an undefined state.");c()}}else if("timeout"===s){var l=r.get(n);if("number"==typeof l){var h=a.get(l);if(void 0===h||h.timerId!==n||h.timerType!==s)throw new Error("The timer is in an undefined state.")}else{if(void 0===l)throw new Error("The timer is in an undefined state.");l(),r.delete(n)}}}else{if(!function(e){return null===e.error&&"number"==typeof e.id}(t)){var u=t.error.message;throw new Error(u)}var p=t.id,m=a.get(p);if(void 0===m)throw new Error("The timer is in an undefined state.");var g=m.timerId,f=m.timerType;a.delete(p),"interval"===f?i.delete(g):r.delete(g)}})),{clearInterval:function(e){var r=t.generateUniqueNumber(a);a.set(r,{timerId:e,timerType:"interval"}),i.set(e,r),o.postMessage({id:r,method:"clear",params:{timerId:e,timerType:"interval"}})},clearTimeout:function(e){var i=t.generateUniqueNumber(a);a.set(i,{timerId:e,timerType:"timeout"}),r.set(e,i),o.postMessage({id:i,method:"clear",params:{timerId:e,timerType:"timeout"}})},setInterval:function(e,r){var a=t.generateUniqueNumber(i);return i.set(a,(function(){e(),"function"==typeof i.get(a)&&o.postMessage({id:null,method:"set",params:{delay:r,now:performance.now(),timerId:a,timerType:"interval"}})})),o.postMessage({id:null,method:"set",params:{delay:r,now:performance.now(),timerId:a,timerType:"interval"}}),a},setTimeout:function(e,i){var a=t.generateUniqueNumber(r);return r.set(a,e),o.postMessage({id:null,method:"set",params:{delay:i,now:performance.now(),timerId:a,timerType:"timeout"}}),a}}},Object.defineProperty(e,"__esModule",{value:!0})},"object"==typeof p?t(p,function(){return u||(u=!0,e=h,t=function(e){var t,i=void 0===Number.MAX_SAFE_INTEGER?9007199254740991:Number.MAX_SAFE_INTEGER,r=1073741824,a=new WeakMap,o=function(e,t){return function(a){var o=t.get(a),n=void 0===o?a.size:o<r?o+1:0;if(!a.has(n))return e(a,n);if(a.size<536870912){for(;a.has(n);)n=Math.floor(Math.random()*r);return e(a,n)}if(a.size>i)throw new Error("Congratulations, you created a collection of unique numbers which uses all available integers!");for(;a.has(n);)n=Math.floor(Math.random()*i);return e(a,n)}}((t=a,function(e,i){return t.set(e,i),i}),a),n=function(e){return function(t){var i=e(t);return t.add(i),i}}(o);e.addUniqueNumber=n,e.generateUniqueNumber=o,Object.defineProperty(e,"__esModule",{value:!0})},"object"==typeof h?t(h):"function"==typeof define&&i.amdO?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).fastUniqueNumbers={})),h;var e,t}()):"function"==typeof define&&i.amdO?define(["exports","fast-unique-numbers"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).workerTimersBroker={},e.fastUniqueNumbers)),p;var e,t}()):"function"==typeof define&&i.amdO?define(["exports","worker-timers-broker"],x):x((y="undefined"!=typeof globalThis?globalThis:y||self).workerTimers={},y.workerTimersBroker)),g);var y,x;function b(){this.PlayOnCanvas=function(e){this.drawmedia=()=>{var t;(function(e){d.offscreenImage=null,l.EffectsInit(e),l.EffectsBeforeDraw(e);var t,i,r=(t=e,(i=d).canvaswidth=t.canvas.width,i.canvasheight=t.canvas.height,i.scenewidth=t.getFrameWidth(),i.sceneheight=t.getFrameHeight(),i.sceneendx=t.getFrameEndx(),i.sceneendy=t.getFrameEndy(),i.defaultx=t.defaultx,i.defaulty=t.defaulty,i.scenebordercolor=t.bordercolor,i.scenebackcolor=t.backcolor,i.sceneborderthickness=t.borderthickness,i.backgroundimg=t.backgroundimg,w.usemaincanvas&&(i.mainCanvasContext=w.objMainCtx),t.backgroundeffects.forEach((e=>{e.mainAlpha.current&&(i.backgroundAlpha=e.mainAlpha.current)})),i);e.pen.PreDraw(e.ctx,r),l.EffectsAfterDraw(e)})(e),0!=(t=e.sortmedia).length&&t.forEach((e=>{e.draw()})),function(e){e.draw()}(e)},v.setInterval((()=>{this.drawmedia()}),1)}}class w{static studioWidth=1280;static studioHeight=720;static dummycanvasctx=(new n).createCanvasTag(1,1,!1).getContext("2d");static useoffscreencanvas=!1;static usemaincanvas=!0;static objMainCtx;static objMainOffScreenCtx;static maincanvas;static scenes=new Array;static logs=new s("logs");static columnlayoutlogs=new s("columnlayout");static objTimeline=new b;static runningeffects=new Array;static completedeffects=new Array;static selectedSceneObj}function A(e,t,i,r,a,o,n){if(this.drawVariables=d,this.overlays=new Array,this.pen=new Pen,this.defaultx=r,this.defaulty=a,this.defaultright=o,this.defaultbottom=n,this.name=e,this.canvas=t,this.isoffscreencanvas=i,this.overlayeffectsmanager=new c(this,null),this.isoffscreencanvas){const e=new Worker("canvas-worker.js");this.worker=e,this.sceneoffscreencanvas=t.transferControlToOffscreen(),1==w.usemaincanvas&&(this.mainoffscreencanvas=w.maincanvas),this.worker.postMessage({sceneoffscreencanvas:this.sceneoffscreencanvas},[this.sceneoffscreencanvas]),1==w.usemaincanvas&&this.worker.postMessage({mainoffscreencanvas:this.mainoffscreencanvas},[this.mainoffscreencanvas])}else this.ctx=t.getContext("2d");this.backcolor="#000000",this.bordercolor="#000000",this.borderthickness=2,this.backgroundimg="",this.backgroundvideo="",this.backgroundeffects=new Array,this.backgroundoverlays=new Array,this.defaultx=0,this.defaulty=0,this.defaultbottom=0,this.defaultright=0,this.getFrameWidth=function(e=this.canvas){return e.width-this.defaultright-this.defaulty},this.getFrameHeight=function(e=this.canvas){return e.height-this.defaultbottom-this.defaultx},this.getFrameEndx=function(e=this.canvas){return this.frameendx=e.width-this.defaultright,this.frameendx},this.getFrameEndy=function(e=this.canvas){return this.frameendy=e.height-this.defaultbottom,this.frameendy},this.completedeffects=new Array,this.allmedia=new Array,this.allmediacopy=new Array,this.sortmedia=new Array,this.draw=()=>{this.overlayeffectsmanager.EffectsInit(this.overlays),this.overlayeffectsmanager.EffectsBeforeDraw(this.overlays);var e,t=(this,(e=this.drawVariables).sceneoverlays=[...this.overlays],e);this.pen.PenDraw(this.ctx,t),this.overlayeffectsmanager.EffectsAfterDraw(this.overlays)},this.bringToFront=e=>{this.sortmedia=[...this.allmedia],this.sortmedia.push(this.sortmedia.splice(this.sortmedia.indexOf(e),1)[0])}}class k{timelinestarted=!1;objhtml=new n;CreateMainCanvas(e){if(w.usemaincanvas){let t=this.objhtml.createCanvasTag(e,w.studioWidth,w.studioHeight,w.usemaincanvas);w.maincanvas=t,w.useoffscreencanvas?w.maincanvas=t.transferControlToOffscreen():w.objMainCtx=w.maincanvas.getContext("2d")}}CreateScene(e){let t=new A(e,this.objhtml.createCanvasTag(e,w.studioWidth,w.studioHeight,!w.usemaincanvas),w.useoffscreencanvas,0,0,0,0);w.scenes.push(t)}StartTimeline(e){1!=this.timelinestarted&&(w.objTimeline.PlayOnCanvas(e),this.timelinestarted=!0)}SelectedScene(e){let t=w.scenes.findIndex((t=>t.name===e));return null==t&&-1==t||(w.selectedSceneObj=w.scenes[t]),w.selectedSceneObj}isMirrorVideo(e){w.scenes[0].isMirrorVideo=e}}class T{constructor(e=null,t=null,i=null,r=null,a=[{current:null,subtarget:null,speed:null}],o=null){this.ThingPropertyTimeline=!0,this.initial=e,this.start=t,this.current=i,this.target=r,this.submovement=a,this.relative=o}get relative(){return this._relative}set relative(e){isNaN(e),this._relative=e}get target(){return this._target}set target(e){isNaN(e),this._target=e}set initial(e){this._initial=e}get initial(){return this._initial}set start(e){this._start=e}get start(){return this._start}set current(e){this._current=e}get current(){return this._current}ApplyInitials(e){this.initial=e,this.start=e,this.current=e,this.relative=e}ApplyAll(e){this.ApplyInitials(e),this.target=e}ApplyTarget(e){this.target=e}}class M{constructor(e=null,t=null){this.r=new T,this.g=new T,this.b=new T,this.a=new T,this.SetColor(t,"target"),this.SetColor(e,"current"),this.SetColor(e,"initial"),this.SetColor(e,"start")}set r(e){this._r=e}get r(){return this._r}set g(e){this._g=e}get g(){return this._g}set b(e){this._b=e}get b(){return this._b}set a(e){this._a=e}get a(){return this._a}ApplyAll(e,t){this.r.ApplyAll(e.r[t]),this.g.ApplyAll(e.g[t]),this.b.ApplyAll(e.b[t]),this.a.ApplyAll(e.a[t])}SetColor(e,t){if(e)for(var i in e)this[i][t]=e[i],null==this[i][t]&&(this[i][t]=0)}toRGBAString(e,t=this){return t.a[e]?"rgba("+t.r[e]+","+t.g[e]+","+t.b[e]+","+t.a[e]+")":"rgba("+t.r[e]+","+t.g[e]+","+t.b[e]+")"}}class S{constructor(e){this.type="not set? or is ThingProperty the problem?",this.name=e,this.x=new T,this.y=new T,this.w=new T,this.h=new T,this.radius=new T,this.mainAlpha=new T,this.forecolor=new M,this.bordercolor=new M}set x(e){this._x=e}get x(){return this._x}set y(e){this._y=e}get y(){return this._y}set w(e){this._w=e}get w(){return this._w}set h(e){this._h=e}get h(){return this._h}set radius(e){this._radius=e}get radius(){return this._radius}set mainAlpha(e){this._mainAlpha=e}get mainAlpha(){return this._mainAlpha}set bordercolor(e){this._bordercolor=e}get bordercolor(){return this._bordercolor}set forecolor(e){this._forecolor=e}get forecolor(){return this._forecolor}}class E extends S{constructor(e){super(e)}ApplyNewTargets(){for(var e in this)if(e.ThingPropertyTimeline)for(var t in e)null!=t.target&&(t.current=t.target)}ApplyTargets(){this.x.current=this.x.target,this.y.current=this.y.target,this.w.current=this.w.target,this.h.current=this.h.target}ApplyRelative(){for(var e in this.thingproperty)for(var t in e)null!=t.relative&&(t.current=t.relative)}ApplyCurrentColors(e,t){t.backcolor&&(e.backcolor.r.current=t.backcolor.r.current,e.backcolor.g.current=t.backcolor.g.current,e.backcolor.b.current=t.backcolor.b.current,e.backcolor.a.current=t.backcolor.a.current),t.bordercolor&&t.bordercolor.r.current&&(e.bordercolor.r.current=t.bordercolor.r.current,e.bordercolor.g.current=t.bordercolor.g.current,e.bordercolor.b.current=t.bordercolor.b.current,e.bordercolor.a.current=t.bordercolor.a.current)}CopyTargetsFromEffect(e){this.x.target?e.x.target=this.x.target:e.x.target=0,this.y.target?e.y.target=this.y.target:e.y.target=0,this.w.target?e.w.target=this.w.target:e.w.target=0,this.h.target?e.h.target=this.h.target:e.h.target=0,"colorFadefx"==e.type&&(this.setColorTargets(e.backcolor,this.backcolor,"target"),this.setColorTargets(e.bordercolor,this.bordercolor,"target"))}setColorTargets(e,t,i="target"){if(e)for(var r in t)t[r][i]=e[r][i]}ApplyEffects(e=null){var t=null;(t=e&&e.length>0?e:[this]).forEach((e=>{e.effects&&e.effects.length>0&&e.effects.forEach((t=>{t.x.current&&(e.x.current=t.x.current),t.y.current&&(e.y.current=t.y.current),t.w.current&&(e.w.current=t.w.current),t.h.current&&(e.h.current=t.h.current),this.ApplyCurrentColors(e,t),null!=t.mainAlpha.current&&(e.mainAlpha.current=t.mainAlpha.current)}))})),t.forEach((e=>{e.overlays&&e.overlays.length>0&&this.ApplyEffects(e.overlays)}))}}class C extends S{constructor(e){super(e),this.videocropx=new T,this.videocropy=new T,this.videocropw=new T,this.videocroph=new T}}class j extends C{constructor(e){super(e)}ApplyNewTargets(){for(var e in this.thingproperty)for(var t in e)null!=t.target&&(t.current=t.target)}ApplyTargets(){this.x.current=this.x.target,this.y.current=this.y.target,this.w.current=this.w.target,this.h.current=this.h.target}ApplyEffects(e=null){var t=null;(t=e&&e.length>0?e:[this]).forEach((e=>{e.effects&&e.effects.length>0&&e.effects.forEach((t=>{t.x.current&&(e.x.current=t.x.current),t.y.current&&(e.y.current=t.y.current),t.w.current&&(e.w.current=t.w.current),t.h.current&&(e.h.current=t.h.current),null!=t.mainAlpha.current&&(e.mainAlpha.current=t.mainAlpha.current)}))})),t.forEach((e=>{e.overlays&&e.overlays.length>0&&this.ApplyEffects(e.overlays)}))}}class V extends j{constructor(e,t,i,r,a,o,n,s,c,d=new T,l=new T){super(e),this.name=e,this.initialcroph=i.videoHeight,this.initialcropw=i.videoWidth,this.videocropw.current=i.videoWidth,this.videocroph.current=i.videoHeight,this.videoheight=i.videoHeight,this.videowidth=i.videoWidth,this.videoduration=i.duration,this.bordercolor="green",this.borderthickness=1,this.realvideo=i,this.scene=r,this.ctx=this.scene.ctx,this.x.initial=a,this.y.initial=o,this.w.initial=i.videoWidth,this.h.initial=i.videoHeight,this.initialcropx=d,this.initialcropy=l,this.framewidth=r.getFrameWidth(),this.frameheight=r.getFrameHeight(),this.x.current=a+r.defaultx,this.y.current=o+r.defaulty,this.w.current=i.videoWidth,this.h.current=i.videoHeight,this.videocropx.current=d.current,this.videocropy.current=l.current,this.x.target=this.x.current,this.y.target=this.y.current,this.w.target=this.w.current,this.h.target=this.h.current,this.videocropx.target=this.videocropx.current,this.videocropy.target=this.videocropy.current,this.videocropw.target=this.videocropw.current,this.videocroph.target=this.videocroph.current,this.isMirrorVideo=c,this.normalAlpha=1,this.mediaAlpha=this.normalAlpha,this.initialAlpha=t,0==this.initialAlpha&&(this.mediaAlpha=this.initialAlpha,this.initialAlpha=this.normalAlpha),this.effects=new Array,this.overlays=new Array,this.num=0,this.realvideo.addEventListener("resize",(e=>{this.num++,console.log("-------------------------------------------------------"),console.log(e.target.videoWidth+this.num),this.num>1&&(window.innerHeight>window.innerWidth?(this.videocropx.current=0,this.videocropy.current=(i.videoHeight-9*i.videoWidth/16)/2,this.videocropw.current=i.videoWidth,this.videocroph.current=9*i.videoWidth/16):(this.videocropx.current=(i.videoWidth-16*i.videoHeight/9)/2,this.videocropy.current=0,this.videocropw.current=16*i.videoHeight/9,this.videocroph.current=i.videoHeight))}))}}function I(e,t){this.objVisualMedia=t,this.mediabox=t.mediabox,this.scene=e,this.overlayeffectsmanager=new c(this.scene,this.mediabox),this.isNaNorUndefined=e=>!(!isNaN(e)&&void 0!==e),this.clearTargets=e=>{e.x.target=0,e.y.target=0,e.w.target=0,e.h.target=0,e.videocropx.target=0,e.videocropy.target=0,e.videocropw.target=0,e.videocroph.target=0},this.AssignMediaboxTargetsToEffect=(e,t)=>{this.isNaNorUndefined(t.x.current)?e.x.current=0:e.x.current=Math.abs(t.x.current),this.isNaNorUndefined(t.y.current)?e.y.current=0:e.y.current=Math.abs(t.y.current),this.isNaNorUndefined(t.w.current)?e.w.current=0:e.w.current=Math.abs(t.w.current),this.isNaNorUndefined(t.h.current)?e.h.current=0:e.h.current=Math.abs(t.h.current),this.isNaNorUndefined(t.videocropx.current)?e.videocropx.current=0:e.videocropx.current=Math.abs(t.videocropx.current),this.isNaNorUndefined(t.videocropy.current)?e.videocropy.current=0:e.videocropy.current=Math.abs(t.videocropy.current),this.isNaNorUndefined(t.videocropw.current)?e.videocropw.current=0:e.videocropw.current=Math.abs(t.videocropw.current),this.isNaNorUndefined(t.videocroph.current)?e.videocroph.current=0:e.videocroph.current=Math.abs(t.videocroph.current),e.x.target=this.isNaNorUndefined(Math.abs(t.x.target))?e.x.target=0:e.x.target=t.x.target,e.y.target=this.isNaNorUndefined(Math.abs(t.y.target))?e.y.target=0:e.y.target=t.y.target,e.w.target=this.isNaNorUndefined(Math.abs(t.w.target))?e.w.target=0:e.w.target=t.w.target,e.h.target=this.isNaNorUndefined(Math.abs(t.h.target))?e.h.target=0:e.h.target=t.h.target,this.isNaNorUndefined(t.videocropx.target)?e.videocropx.target=0:e.videocropx.target=Math.abs(t.videocropx.target),this.isNaNorUndefined(t.videocropy.target)?e.videocropy.target=0:e.videocropy.target=Math.abs(t.videocropy.target),this.isNaNorUndefined(t.videocropw.target)?e.videocropw.target=0:e.videocropw.target=Math.abs(t.videocropw.target),this.isNaNorUndefined(t.videocroph.target)?e.videocroph.target=0:e.videocroph.target=Math.abs(t.videocroph.target)},this.AssignEffectToMediabox=(e,t)=>{this.isNaNorUndefined(e.x.current)?t.x.current=0:t.x.current=e.x.current,this.isNaNorUndefined(e.y.current)?t.y.current=0:t.y.current=e.y.current,this.isNaNorUndefined(e.w.current)?t.w.current=0:t.w.current=e.w.current,this.isNaNorUndefined(e.h.current)?t.h.current=0:t.h.current=e.h.current,this.isNaNorUndefined(e.videocropx.current)?t.videocropx.current=0:t.videocropx.current=e.videocropx.current,this.isNaNorUndefined(e.videocropy.current)?t.videocropy.current=0:t.videocropy.current=e.videocropy.current,this.isNaNorUndefined(e.videocropw.current)?t.videocropw.current=0:t.videocropw.current=e.videocropw.current,this.isNaNorUndefined(e.videocroph.current)?t.videocroph.current=0:t.videocroph.current=e.videocroph.current},this.EffectsInit=e=>{this.overlayeffectsmanager.EffectsInit(this.objVisualMedia.overlays),e.forEach((e=>{0==e.initdone&&("movencropfx"==e.type&&this.AssignMediaboxTargetsToEffect(e,this.objVisualMedia.mediabox),e.InitStart(),e.initdone=!0)}))},this.EffectsBeforeDraw=e=>{this.overlayeffectsmanager.EffectsBeforeDraw(this.objVisualMedia.overlays,this.objVisualMedia),e.forEach((e=>{this.objVisualMedia.ApplyEffects(),"movencropfx"==e.type&&this.AssignMediaboxTargetsToEffect(e,this.objVisualMedia.mediabox),e.beforeDraw()}))},Array.prototype.remove=function(e){return-1!=this.indexOf(e)&&(this.splice(this.indexOf(e),1),!0)},this.EffectsAfterDraw=i=>{this.overlayeffectsmanager.EffectsAfterDraw(this.objVisualMedia.overlays),i.forEach((r=>{"movencropfx"==r.type&&this.AssignEffectToMediabox(r,this.objVisualMedia.mediabox),r.afterDraw(),1==r.completed&&(r.initdone=!1,1==r.removefromscene&&e.sortmedia.splice(e.sortmedia.indexOf(t),1),i.remove(r))}))}}Array.prototype.remove=function(e){return-1!=this.indexOf(e)&&(this.splice(this.indexOf(e),1),!0)};class _ extends V{constructor(e,t,i,r,a,o,n,s,l,h=new T,u=new T){super(e,t,i,r,a,o,n,s,l,h,u),this.mediabox=this,this.drawVariables=d,this.video=this.realvideo,this.objPen=this.scene.pen,this.scene=r,this.mediaeffectsmanager=new I(this.scene,this),this.overlayeffectsmanager=new c(this.scene,this),this.isMirrorVideo=l}listenChangesinArray(e,t){["push"].forEach((i=>{e[i]=function(){var r=Array.prototype[i].apply(e,arguments);return t.apply(e,arguments),r}}))}effectCompleted=e=>{w.completedeffects.push(e),objMediaBox.effects.remove(e)};addEffect=async e=>new Promise(((t,i)=>{this.effects.push(e),this.detectednewcompletedeffect=()=>{w.completedeffects[w.completedeffects.indexOf(e)]==e&&(t(this),w.completedeffects.remove(e))},this.listenChangesinArray(w.completedeffects,this.detectednewcompletedeffect),setTimeout((()=>{0!=this.effects.length&&(i(this,"timed out..Is this effect stuck for over 10 seconds?"),console.log("rejected"))}),1e4)}));draw=()=>{this.offscreenImage=null,this.mediaeffectsmanager.EffectsInit(this.effects),this.mediaeffectsmanager.EffectsBeforeDraw(this.effects);var e,t,i=(e=this,(t=this.drawVariables).sceneoverlays=null,null!=e.offscreenImage?t.video=e.offscreenImage:(t.mainCanvasContext=w.objMainCtx,t.video=e.realvideo),t.isMirrorVideo=e.isMirrorVideo,t.mediaborderthickness=e.borderthickness,t.mediabordercolor=e.bordercolor,t.videocropy=e.videocropy.current,t.videocroph=e.videocroph.current,t.videocropw=e.videocropw.current,t.videocropx=e.videocropx.current,t.x=e.x.current,t.y=e.y.current,t.w=e.w.current,t.h=e.h.current,t.mediaAlpha=e.initialAlpha,e.overlays&&0!=e.overlays.length&&(t.overlays=[...e.overlays]),0!=e.effects.length&&e.effects.forEach((e=>{e.mainAlpha.current&&(t.mediaAlpha=e.mainAlpha.current)})),t);this.objPen.PenDraw(this.scene.ctx,i),this.mediaeffectsmanager.EffectsAfterDraw(this.effects)}}class D extends E{constructor(e,t,i,r,a,o,n,s){super(e),this.overlayname=e,this.effects=new Array,s&&(this.effects=s),this.type="imageoverlay",this.image=o,this.mainAlpha.ApplyTarget(n),this.x.ApplyAll(t),this.y.ApplyAll(i),this.w.ApplyTarget(o.naturalWidth),this.h.ApplyTarget(o.naturalHeight),this.left_or_right=r,this.top_or_bottom=a,this.objectwidth=this.image.naturalWidth,this.objectheight=this.image.naturalHeight}RecalculatePosition(){null!=this.x.initial&&(this.x.target=this.x.relative),null!=this.y.initial&&(this.y.target=this.y.relative)}}class O extends E{constructor(e,t,i,r,a,o,n,s,c,d,l,h,u,p,m,g,f,v,y,x,b){super(e),this.overlayname=e,this.type="tickeroverlay",this.effects=new Array,this.x.current=t,this.y.current=i,this.radius=0,this.initialRadius=this.radius,this.targetRadius=this.radius,this.tickerx=t,this.backcolor=l,this.initialBackgroundAlpha=h,this.targetBackgroundAlpha=h,this.backgroundAlpha=h,this.mainAlpha.ApplyTarget(h),this.forecolor=u,this.font=y,this.initialForegroundAlpha=p,this.targetForegroundAlpha=p,this.foregroundAlpha=p,this.bordercolor=m,this.borderthickness=g,this.initialBorderAlpha=f,this.targetBorderAlpha=f,this.borderAlpha=f,this.direction=x,this.speed=b,this.content=v,this.framestartx=n,this.frameendx=s,this.textwidth=c,this.textheight=d,this.left_or_right="left",this.top_or_bottom=o,this.xspacing=r,this.yspacing=a}RecalculatePosition(){"left"==this.direction?(this.x.current=this.x.current-this.speed,parseFloat(this.x.current)<parseFloat(this.framestartx)-txtlength&&(this.x.current=this.frameendx)):(this.x.current=this.x.current+this.speed,parseFloat(this.x.current)>parseFloat(this.frameendx)+parseFloat(this.textwidth)&&(this.x.current=parseFloat(this.framestartx)-parseFloat(this.textwidth)))}ApplyTargets(){}ApplyEffects(){}}class N extends E{constructor(e,t,i,r,a,o,n,s,c,d,l,h,u){console.log(e,t,i,r,a,o,n,s,c,d,l,h,u),super(e),this.name=e,this.overlayname=e,this.effects=new Array,this.effects=u,this.type="rectangleoverlay",this.overlays=new Array,this.initialRadius=o,this.targetRadius=o,this.radius=o,this.bordercolor=l,this.borderthickness=h,this.bordercolor.ApplyAll(l,"current"),this.x.ApplyAll(t),this.y.ApplyAll(i),this.w.ApplyAll(n),this.h.ApplyAll(s),this.mainAlpha.ApplyTarget(d),this.objectwidth=n,this.objectheight=s,this.backcolor=c,this.left_or_right=r,this.top_or_bottom=a}RecalculatePosition(){null!=this.x.initial&&(this.x.target=this.x.relative),null!=this.y.initial&&(this.y.target=this.y.relative);var e=this.CalculateSubOverlaysSize();this.objectwidth=this.w.target+e.w,this.objectheight=this.h.target+e.h}CalculateSubOverlaysSize(){var e=0;return this.overlays&&this.overlays.length>0&&this.overlays.forEach((t=>{"left"==t.left_or_right&&(e+=t.w.target+t.x.target),"right"==t.left_or_right&&(e+=t.w.target)})),{w:e,h:0}}}class P extends E{objUtil=new o;constructor(e,t,i,r,a,o,n,s,c,d){console.log(e,t,i,r,a,o,n,s,c,d),super(e),this.name=e,this.overlayname=e,this.effects=new Array,this.effects=d,this.type="textoverlay",this.mainAlpha.ApplyAll(n),this.text=s,this.font=c,this.overlays=new Array,this.w.ApplyAll(this.objUtil.measureTextWidth(s,c)),this.h.ApplyAll(this.objUtil.measureTextHeight(c)),this.x.ApplyAll(t),this.y.ApplyAll(i),this.forecolor=o,this.left_or_right=r,this.top_or_bottom=a}RecalculatePosition(){null!=this.x.initial&&(this.x.target=this.x.relative),null!=this.y.initial&&(this.y.target=this.y.relative);var e=this.CalculateSubOverlaysSize();this.w.target=e.w,this.h.target=e.h}CalculateSubOverlaysSize(){var e=0;return this.overlays&&this.overlays.length>0&&this.overlays.forEach((t=>{"left"==t.left_or_right&&(e+=t.w.target+t.x.target,this.initialxspacing,this.xspacing=t.w.target+t.x.relative+this.initialxspacing),"right"==t.left_or_right&&(e+=t.w.target)})),{w:e,h:0}}}class L extends S{constructor(e,t=.01,i=1,r=0){super(e),this.type="fadeinfx",this.initdone=!1,this.mainAlpha.start=r,this.mainAlpha.current=0,this.mainAlpha.target=i,this.completed=!1,this.mainAlpha.target=i,this.mainAlpha.speed=t}InitStart=()=>{0==this.initdone&&(this.initdone=!0)};beforeDraw=()=>{this.mainAlpha.current+=parseFloat(this.mainAlpha.speed)};afterDraw=()=>{this.mainAlpha.current>=this.mainAlpha.target&&(this.mainAlpha.current=this.mainAlpha.target,this.initdone=!1,this.completed=!0)}}let R=new o;class F extends S{constructor(e,t=.01,i=!0){super(e),this.type="fadeoutfx",this.initdone=!1,this.mainAlpha.current=.9,this.mainAlpha.target=.01,this.totaliterations=0,this.currentiteration=0,this.mainAlpha.speed=t,this.completed=!1,this.removefromscene=i,this.InitStart=()=>{0==this.initdone&&(this.initdone=!0,this.totaliterations=this.mainAlpha.current/this.mainAlpha.speed)}}beforeDraw=()=>{if(this.currentiteration++,this.currentiteration<=this.totaliterations){var e=parseFloat(this.mainAlpha.current)-parseFloat(this.mainAlpha.speed);-1!=Math.sign(e)&&(this.mainAlpha.current=e)}};afterDraw=()=>{this.mainAlpha.current<=this.mainAlpha.speed&&(this.mainAlpha.current=0),this.currentiteration>=this.totaliterations&&(this.mainAlpha.current=0,this.initdone=!1,this.completed=!0,this.currentiteration=0)}}let U=new class{CreateTextOverlay(e,t,i,r,a){return this.name=e,this.labeltxt=i,this.font="20px Helvetica",this.x=R.getPercentageValue(2,t.objectwidth),this.y=R.getPercentageValue(20,t.objectheight),this.left_or_right=r,this.top_or_bottom=a,this.forecolor=new M({r:255,g:255,b:255,a:1}),this.mainAlpha=1,this.effects=[new L("textoverlay-fadein",.01)],this.objTextOverlay=new P(this.name,this.x,this.y,this.left_or_right,this.top_or_bottom,this.forecolor,this.mainAlpha,this.labeltxt,"20px Helvetica",this.effects),this.objTextOverlay}CreateRectangleOverlay(e,t,i,r,a){return this.font="20px Helvetica",this.name=e,this.x=10,this.y=10,this.left_or_right=i,this.top_or_bottom=r,this.radius=a,this.textoverlayheight=R.measureTextHeight(this.font),this.textoverlaywidth=R.measureTextWidth(t,this.font),this.rectanglewidth=this.textoverlaywidth+10,this.rectangleheight=this.textoverlayheight+5,this.backcolor=new M({r:0,g:0,b:0,a:1}),this.mainAlpha=1,this.bordercolor=new M({r:0,g:0,b:0,a:1}),this.borderthickness=1,this.effects=[new L("rectangle-fadein",.01,1)],this.objRectangleOverlay=new N(this.name,this.x,this.y,this.left_or_right,this.top_or_bottom,this.radius,this.rectanglewidth,this.rectangleheight,this.backcolor,this.mainAlpha,this.bordercolor,this.borderthickness,this.effects),this.objRectangleOverlay}CreateImageOverlay(e,t,i,r){return this.name=e,this.x=60,this.y=120,this.left_or_right=i,this.top_or_bottom=r,this.imagefilepath=t,this.image=this.imagefilepath,this.mainAlpha=1,this.effects=[new L("logo-img-fadein",.01,1)],this.objImageOverlay=new D(this.name,this.x,this.y,this.left_or_right,this.top_or_bottom,this.image,this.mainAlpha,this.effects),this.objImageOverlay}CreateTickerOverlay(e,t,i,r,a){return this.name=e,this.tickertext=t,this.font="20px Arial",this.tickertextwidth=R.measureTextWidth(this.tickertext,this.font),this.tickertextheight=R.measureTextHeight(this.font),this.tickerobjectheight=this.tickertextheight+30,this.x=0,this.y=i.getFrameEndy()-this.tickerobjectheight,this.xspacing=0,this.yspacing=10,this.top_or_bottom=r,this.framestartx=i.defaultx,this.frameendx=i.getFrameEndx(),this.backcolor=new M({r:0,g:0,b:0,a:.2}),this.backgroundAlpha=.2,this.forecolor=new M({r:250,g:50,b:150,a:1}),this.foregroundAlpha=1,this.bordercolor=new M({r:250,g:250,b:250,a:1}),this.borderthickness=5,this.borderAlpha=.9,this.direction=a,this.speed=6,this.objTickerOverlay=new O(this.name,this.x,this.y,this.xspacing,this.yspacing,this.top_or_bottom,this.framestartx,this.frameendx,this.tickertextwidth,this.tickertextheight,this.backcolor,this.backgroundAlpha,this.forecolor,this.foregroundAlpha,this.bordercolor,this.borderthickness,this.borderAlpha,this.tickertext,this.font,this.direction,this.speed),this.objTickerOverlay}};class B{objhtml=new n;ShowOverlay(e,t){console.log("objoverlay",t),"tickeroverlay"==!t.type&&t.effects.push(new L("overlay-fadein",.01,.9)),t.overlays&&t.overlays.length>0&&t.overlays.forEach((e=>{e.effects.push(new L("TEXTFADEIN",.01,.9))})),e.overlays.push(t)}HideOverlay(e,t){let i=e.overlays.findIndex((e=>e.name===t));if((null!=i||-1!=i)&&e.overlays[i].effects){if("tickeroverlay"==e.overlays[i].type)return void e.overlays.splice(i,1);e.overlays[i].effects.push(new F("overlay-fadeout",.01,!0))}"overlays"in e.overlays[i]&&e.overlays[i].overlays.length>0&&e.overlays[i].overlays.forEach((e=>{e&&e.effects.push(new F("overlay-fadeout",.01,!0))}))}async ShowBackground(e,t){e.backgroundimg=await this.objhtml.createImageTag(t),e.backgroundeffects.push(new L("bg-fadein",.01,1))}async HideBackground(e){e.backgroundeffects.push(new F("bg-fadeout",.01,!1))}async CreateImageOverlay(e,t,i,r){let a=await this.objhtml.createImageTag(t);return U.CreateImageOverlay(e,a,i,r)}CreateTextOverlay(e,t,i,r,a){let o=U.CreateRectangleOverlay(e,t,i,r,a),n=U.CreateTextOverlay(e,o,t,i,r);return o.overlays.push(n),o}CreateTickerOverlay(e,t,i,r,a){return U.CreateTickerOverlay(e,t,i,r,a)}CreateRectangleOverlay(e,t,i,r,a){return U.CreateRectangleOverlay(e,t,i,r,a)}}class H{constructor(e,t){this.movespeed=t,this.name=e}move(e,t,i){var r=this.Difference(e,t),a=this.movespeed;return e||e>=0?(r<this.movespeed&&(a=r),e<t&&(e+=a),e>t&&(e-=a),e):(e=t,t||e||(t=0),e=0)}Difference(e,t){return t>e?t-e:e>t?e-t:0}CheckTargets(e,t,i){return Math.trunc(e)==Math.trunc(t)}CheckIteration(e,t){return e==t}}class W extends C{constructor(e,t=1,i=0,r=0,a=0,o=0){super(e),this.name=e,this.movespeed=t,this.type="movencropfx",this.AssignValues=e=>{this.initdone=!1,this.completed=!1,this.movespeed=e,this.x.current=0,this.y.current=0,i&&(this.x.current=i),r&&(this.y.current=r),this.w.current=0,this.h.current=0,a&&(this.w.current=a),o&&(this.h.current=o),this.videocropx.current=0,this.videocropy.current=0,this.videocropw.current=0,this.videocroph.current=0,this.x.target=0,this.y.target=0,this.w.target=0,this.h.target=0,this.videocropx.target=0,this.videocropy.target=0,this.videocropw.target=0,this.videocroph.target=0,this.xdone=!1,this.ydone=!1,this.wdone=!1,this.hdone=!1,this.cropxdone=!1,this.cropydone=!1,this.cropwdone=!1,this.crophdone=!1,this.mover=new H(this.name,this.movespeed)},this.AssignValues(t)}InitStart=()=>{0==this.initdone&&(this.initdone=!0)};beforeDraw=()=>{this.alldone()||(this.x.current=this.mover.move(Math.abs(this.x.current),Math.abs(this.x.target),this.xdone),this.y.current=this.mover.move(Math.abs(this.y.current),Math.abs(this.y.target),this.ydone),this.w.current=this.mover.move(Math.abs(this.w.current),Math.abs(this.w.target),this.wdone),this.h.current=this.mover.move(Math.abs(this.h.current),Math.abs(this.h.target),this.hdone),this.videocropx.current=this.mover.move(Math.abs(this.videocropx.current),Math.abs(this.videocropx.target),this.cropxdone),this.videocropy.current=this.mover.move(Math.abs(this.videocropy.current),Math.abs(this.videocropy.target),this.cropydone),this.videocropw.current=this.mover.move(Math.abs(this.videocropw.current),Math.abs(this.videocropw.target),this.cropwdone),this.videocroph.current=this.mover.move(Math.abs(this.videocroph.current),Math.abs(this.videocroph.target),this.crophdone))};FixNumber=e=>parseFloat(e);afterDraw=()=>{this.xdone=this.mover.CheckTargets(this.x.current,this.x.target,this.xdone),this.ydone=this.mover.CheckTargets(this.y.current,this.y.target,this.ydone),this.wdone=this.mover.CheckTargets(this.w.current,this.w.target,this.wdone),this.hdone=this.mover.CheckTargets(this.h.current,this.h.target,this.hdone),this.cropxdone=this.mover.CheckTargets(this.videocropx.current,this.videocropx.target,this.cropxdone),this.cropydone=this.mover.CheckTargets(this.videocropy.current,this.videocropy.target,this.cropydone),this.cropwdone=this.mover.CheckTargets(this.videocropw.current,this.videocropw.target,this.cropwdone),this.crophdone=this.mover.CheckTargets(this.videocroph.current,this.videocroph.target,this.crophdone),1==this.alldone()&&(this.initdone=!0,this.completed=!0)};alldone=()=>!!(this.xdone&&this.ydone&&this.wdone&&this.hdone&&this.cropxdone&&this.cropydone&&this.cropwdone&&this.crophdone)}class z{constructor(e,t,i,r,a,n,s=!1){this.name=e,this.scene=t,this.objLayout=new Z(t),this.objUtil=new o,1==s?(this.xgap=this.objUtil.getPercentageValue(a,t.getFrameWidth()),this.ygap=this.objUtil.getPercentageValue(n,t.getFrameHeight()),this.tilewidth=this.objUtil.getPercentageValue(i,t.getFrameEndx()-2*t.defaultx),this.tileheight=this.objUtil.getPercentageValue(r,t.getFrameHeight())):(this.tilewidth=i,this.tileheight=r,this.xgap=a,this.ygap=n)}getNextPosition(e,t,r,a,o,n){var s={};if(0==t.length)return{x:i.g.Global.defaultx,y:i.g.Global.defaulty,h:a,w:r};var c=e.x.target,d=e.y.target,l=e.w.target,h=e.h.target,u=e.scene.getFrameEndx(),p=e.scene.getFrameEndy(),m=d;if(c+r+r+o>u&&(m=d+h+n,c=this.scene.defaultx,l=0,o=0,m+a>p))throw console.log("full"),"Grid full";return s.x=c+l+o,s.y=m,s.h=a,s.w=r,s.xgap=o,s.ygap=n,s.y+a>e.scene.getFrameEndy()&&console.log(e.scene.getFrameHeight()+"GRID FULL. y + height goes beyond the bottom edge even when not overflowing ...y.current : "+d.toString()+" AND "+a.toString()),s}SetDefaultCrop(e){e.forEach((e=>{e.videocropx.target=0,e.videocropy.target=0,e.videocropw.target=e.realvideo.videoWidth,e.videocroph.target=e.realvideo.videoHeight}))}ReArrange(e=this.scene,t,i){this.SetDefaultCrop(t),t.length>0&&t.forEach((i=>{if(0==t.indexOf(i))i.x.target=e.defaultx,i.y.target=e.defaulty,i.w.target=this.tilewidth,i.h.target=this.tileheight;else{var r=this.getNextPosition(t[t.indexOf(i)-1],t,this.tilewidth,this.tileheight,this.xgap,this.ygap);i.x.target=r.x,i.y.target=r.y,i.w.target=r.w,i.h.target=r.h}}))}ApplyAnimatedTargets(e,t){e.forEach((e=>{e.effects.push(new W("movencropfx from gridlayout",t))}))}ApplyTargets(e){e.forEach((e=>{e.x.current=e.x.target,e.y.current=e.y.target,e.h.current=e.h.target,e.w.current=e.w.target,e.videocropx.current=e.videocropx.target,e.videocropw.current=e.videocropw.target,e.videocroph.current=e.videocroph.target,e.videocropy.current=e.videocropy.target}))}}var q=new o;class G{constructor(e,t,i){this.name=e,this.objScene=t,this.gapxpercent=i}ReArrange(e,t,i){this.mediaarray=t;let r=e.getFrameEndx()-e.defaultx,a=e.getFrameEndy()-e.defaulty,o=100/t.length,n=q.getPercentageValue(this.gapxpercent,r),s=q.getPercentageValue(o,r)-e.defaultx,c=a-e.defaulty,d=e.defaultx;t.forEach((e=>{let i=function(e,t){var i,r;r=e.videoheight,i=e.videowidth,console.log("source width height ",r,i);let a=q.getPercentageValue(50,i),o=t%2==0;console.log("centerxofvideo evenorodd ",a,o);let n=i/t,s=o?n:Math.round(n/2);console.log("piecewidth,movepoint",n,s);let c=a-s,d=c-n;return console.log("****************"),{videostartx:c,videoendx:d}}(e,t.length);e.x.target=Math.abs(d),e.y.target=Math.abs(this.objScene.defaulty),e.w.target=Math.abs(s),e.h.target=Math.abs(c),e.videocropx.target=Math.abs(i.videostartx),e.videocropw.target=Math.abs(i.videoendx),e.videocropy.target=0,e.videocroph.target=Math.abs(e.videoheight),d+=Math.abs(s)+Math.abs(n)}))}ApplyAnimatedTargets(e,t){e.forEach((e=>{e.effects.push(new W("movencrop effect from column layout",t))}))}ApplyTargets(e){e.forEach((e=>{e.x.current=e.x.target,e.y.current=e.y.target,e.h.current=e.h.target,e.w.current=e.w.target,e.videocropx.current=e.videocropx.target,e.videocropw.current=e.videocropw.target,e.videocroph.current=e.videocroph.target,e.videocropy.current=e.videocropy.target}))}}var J=new o;class X{constructor(e,t,i,r,a,o,n){this.name=e,this.mediaperrow=t,this.gapx=J.getPercentageValue(a,n.getFrameWidth()),this.gapy=J.getPercentageValue(o,n.getFrameHeight()),this.tileheight=J.getPercentageValue(i,n.getFrameHeight()),this.tilewidth=J.getPercentageValue(r,n.getFrameWidth()),this.objScene=n}ApplyTargets(e){e.forEach((e=>{e.x.current=e.x.target,e.y.current=e.y.target,e.h.current=e.h.target,e.w.current=e.w.target,e.videocropx.current=e.videocropx.target,e.videocropy.current=e.videocropy.target,e.videocropw.current=e.videocropw.target,e.videocroph.current=e.videocroph.target}))}ApplyAnimatedTargets(e,t){e.forEach((e=>{e.effects.push(new W("movencrop from centerlayout",t))}))}SetDefaultCrop(e){e.forEach((e=>{e.h.target=this.tileheight,e.w.target=this.tilewidth,e.videocropx.target=0,e.videocropy.target=0,e.videocropw.target=e.realvideo.videoWidth,e.videocroph.target=e.realvideo.videoHeight}))}ReArrange(e,t,i){this.ReCalculate(e,t)}ReCalculate(e,t){this.SetDefaultCrop(t),this.objScene=e,this.getCenterY=(e,t)=>J.getPercentageValue(50,e.getFrameHeight())-J.getPercentageValue(50,t.h.target),this.getCenterX=(e,t)=>{var i=0,r=e.getFrameEndx()-e.defaultx,a=J.getPercentageValue(50,r);return t.forEach((e=>{i+=e.w.target+this.gapx})),a-J.getPercentageValue(50,i)};var i,r,a=0,o=(i=t,r=this.mediaperrow,[...Array(Math.ceil(i.length/r))].map(((e,t)=>i.slice(r*t,r+r*t))));o.forEach((e=>{this.SetDefaultCrop(e);var t=this.getCenterX(this.objScene,e);a+=1;var i=0,r=0;e.forEach((n=>{if(i++,r=this.getCenterY(this.objScene,n),a>1){var s=o[o.indexOf(e)-1][i-1];r=s.y.target+s.h.target+this.gapy}else if(o.length>1){var c=o[o.indexOf(e)+1],d=c[i]?c[i-1]:c[c.length-1];r-=(d.h.target+this.gapy)*(o.length-1)/2}n.x.target=t,n.y.target=r,t+=n.w.target+this.gapx}))})),this.SetDefaultCrop(t)}}var Q=new o;class Y{constructor(e,t,i,r,a,o){this.name=e,this.objScene=o,this.gapxpercent=t,this.gapypercent=i,this.mainvideowidthpercent=r,this.mainvideoheightpercent=a}ApplyTargets(e){e.forEach((e=>{e.x.current=e.x.target,e.y.current=e.y.target,e.h.current=e.h.target,e.w.current=e.w.target,e.videocropx.current=e.videocropx.target,e.videocropw.current=e.videocropw.target,e.videocroph.current=e.videocroph.target,e.videocropy.current=e.videocropy.target}))}ApplyAnimatedTargets(e,t){e.forEach((e=>{e.effects.push(new W("movencropfx from CornerLayout",t))}))}ReArrange(e,t,i){this.objMainVideo=i,i||(this.objMainVideo=t[0]),this.objScene=e;var r=this.objScene.getFrameEndx()-this.objScene.defaultx,a=this.objScene.getFrameEndy()-this.objScene.defaulty,o=this.mainvideowidthpercent-this.gapxpercent,n=this.mainvideoheightpercent-this.gapypercent,s=100-o-this.gapxpercent,c=100-n-this.gapypercent,d=Q.getPercentageValue(this.gapxpercent,r),l=Q.getPercentageValue(this.gapypercent,a),h=(t.length,t.length,Q.getPercentageValue(o,r)),u=Q.getPercentageValue(n,a),p=this.objScene.defaultx,m=this.objScene.defaulty;let g=Q.getPercentageValue(s,r)-d,f=Q.getPercentageValue(c,a)-l,v=this.objScene.defaultx+h+d,y=this.objScene.defaulty+u+l;var x=this.objScene.defaultx,b=this.objScene.defaulty;this.objMainVideo.x.target=p,this.objMainVideo.y.target=m,this.objMainVideo.w.target=h,this.objMainVideo.h.target=u,this.objMainVideo.videocropx.target=0,this.objMainVideo.videocropy.target=0,this.objMainVideo.videocropw.target=i.realvideo.videoWidth,this.objMainVideo.videocroph.target=i.realvideo.videoHeight,t.forEach((e=>{e!=this.objMainVideo&&(e.videocropx.target=0,e.videocropy.target=0,e.videocropw.target=e.realvideo.videoWidth,e.videocroph.target=e.realvideo.videoHeight,e.x.target=v,e.y.target=b,b+=f+l,e.w.target=g,e.h.target=f,b+l>a&&(e.y.target=y,e.x.target=x,(x+=e.w.target+d)+g>r-g))&&console.log("CORNER LAYOUT grid full. Change the mainvideo's size to show all videos.Use a larger value for the mainvideo or reduce the number of videos")}))}}class K{constructor(e,t,i=!1){this.name=e,this.withoutborder=i,this.objScene=t}SetDefaultCrop(e){e.videocropx.target=0,e.videocropy.target=0,e.videocropw.target=e.realvideo.videoWidth,e.videocroph.target=e.realvideo.videoHeight}ReArrange(e=this.objScene,t,i){this.SetDefaultCrop(i),this.fullscreenvideo=i,this.objScene.bringToFront(this.fullscreenvideo),0==this.withoutborder?(i.x.target=this.objScene.defaultx,i.y.target=this.objScene.defaulty,i.w.target=this.objScene.getFrameWidth()-this.objScene.defaultx,i.h.target=this.objScene.getFrameHeight()-this.objScene.defaulty):(i.x.target=0,i.y.target=0,i.w.target=w.studioWidth,i.h.target=w.studioHeight)}ApplyTargets(e){e.forEach((e=>{e.x.current=e.x.target,e.y.current=e.y.target,e.h.current=e.h.target,e.w.current=e.w.target,e.videocropx.current=e.videocropx.target,e.videocropw.current=e.videocropw.target,e.videocroph.current=e.videocroph.target,e.videocropy.current=e.videocropy.target}))}ApplyAnimatedTargets(e,t){e.forEach((e=>{e.effects.push(new W("moveandcropfx from fullscreen layout",t))}))}}class Z{selectedLayout(e,t){switch(e){case"center":this.Apply(new X("center layout1",3,50,33.33,0,0,t),t);break;case"corner":this.Apply(new Y("corner layout1",1,2,75,75,t),t);break;case"3center":this.Apply(new X("3center",2,50,50,0,0,t),t);break;case"4grid":this.Apply(new Y("full4grid",0,0,50,50,t),t);break;case"grid":default:this.Apply(new z("grid layout1",t,24,23,1.2,2.2,!0),t);break;case"column":this.Apply(new G("column layout1",t,1),t);break;case"fullscreen":this.Apply(new K("fullscreen layout",t,!1),t)}}Apply(e,t){e.ReArrange(t,t.allmedia,t.allmedia[0]),e.ApplyAnimatedTargets(t.allmedia,30)}}var ee=new o;let te=new B,ie=new Z;class re{objhtml=new n;videowidth=ee.getPercentageValue(30,w.studioWidth);videoheight=ee.getPercentageValue(30,w.studioHeight);async createMedia(e,t,i,r,a=null){let o;if("videofile"==t){const e=["FILES/videos/person3.mp4","FILES/videos/bigbuckbunnyhd.mp4","FILES/videos/person.mp4","FILES/videos/person1.mp4","FILES/videos/person2.mp4"];o=e[Math.floor(Math.random()*e.length)]}else o="No video"==i?"resources/videos/blank.mp4":i;let n=await this.objhtml.createMediaTag(e,t,o,r,200,"auto",a);if(!e)return n;n.addEventListener("resize",(e=>{console.log("^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^"),console.log(e.target.videoWidth+" : "+e.target.videoHeight)}));let s=new _(r,0,n,w.selectedSceneObj,w.selectedSceneObj.defaultx,w.selectedSceneObj.defaulty,n.videoWidth,n.videoHeight,!0);return s.bordercolor="white",console.log(s),w.selectedSceneObj.allmediacopy.push(s),null!=a&&s.overlays.push(te.CreateTextOverlay("medialabel_"+r,a,"left","top",{tl:10,br:10,tr:10,bl:10})),s}async createAudio(e,t){return await this.objhtml.createAudioTag(e,t)}FlipMedia(e){w.selectedSceneObj.allmedia.find((t=>{t.mediabox.name===e&&(t.isMirrorVideo=!t.isMirrorVideo)}))}ShowMedia(e){let t=w.selectedSceneObj.allmediacopy.find((t=>t.mediabox.name===e));return w.selectedSceneObj.allmedia.push(t),w.scenes.forEach((e=>{e.sortmedia=[...e.allmedia]})),this.assignLayout(w.selectedSceneObj),t}HideMedia(e){let t=w.selectedSceneObj.sortmedia.findIndex((t=>t.mediabox.name===e)),i=w.selectedSceneObj.allmedia.findIndex((t=>t.mediabox.name===e));null==t&&-1==t||w.selectedSceneObj.sortmedia.splice(t,1),null==i&&-1==i||w.selectedSceneObj.allmedia.splice(i,1),this.assignLayout(w.selectedSceneObj)}RemoveMedia(e){let t=w.selectedSceneObj.allmediacopy.findIndex((t=>t.mediabox.name===e));null==t&&-1==t||w.selectedSceneObj.allmediacopy.splice(t,1)}assignLayout(e){return 1==e.allmedia.length?ie.selectedLayout("fullscreen",e):2==e.allmedia.length||3==e.allmedia.length?ie.selectedLayout("3center",e):4==e.allmedia.length?ie.selectedLayout("4grid",e):e.allmedia.length>4&&e.allmedia.length<7?ie.selectedLayout("center",e):e.allmedia.length>6&&e.allmedia.length<9?ie.selectedLayout("corner",e):void 0}}let ae=new Z;class oe{selectedLayout(e,t){ae.selectedLayout(e,t)}}class ne{scenewrapper=new k;mediawrapper=new re;layoutwrapper=new oe;overlaywrapper=new B;CreateStudio(e){this.scenewrapper.CreateMainCanvas("MainCanvas"),this.scenewrapper.CreateScene(e),this.selectedsceneobj=this.scenewrapper.SelectedScene(e),this.scenewrapper.StartTimeline(this.selectedsceneobj)}}let se=new ne;class ce{VideoSourceType={type1:"localstream",type2:"remotestream",type3:"videofile",type4:"screenshare",type5:"videolink"};VideoResolutions=[{value:"720p",name:"High Definition (720p)",width:1280,height:720},{value:"480p",name:"Standard Definition (480p)",width:320,height:240},{value:"360p",name:"Low Definition (360)",width:480,height:360}];initializeCamera(e){self=this;try{this.getConnectedMediaDevices((function(){self.getCamera((function(t){self.getMic((function(t){notification("Intialized camera !","success"),e()}))}))}))}catch(t){notification(t,"failure"),e(t)}}getCamera(e){self=this,r.x.Constraints.video?self.getUserMedia("video",(function(t){t?(r.x.isCameraAvailable=!0,r.x.localMediaVideoStream=t,self.setup_local_media_preview(t,"preview"),e(r.x.isCameraAvailable)):(r.x.isCameraAvailable=!1,notification("Camera is not available","failure"),e(r.x.isCameraAvailable))})):(r.x.isCameraAvailable=!1,notification("Camera is not available","failure"),e(r.x.isCameraAvailable))}getMic(e){self=this,r.x.Constraints.audio?self.getUserMedia("audio",(function(t){t?(r.x.isMicAvailable=!0,r.x.localMediaAudioStream=t,e(r.x.isMicAvailable)):(r.x.isMicAvailable=!1,notification("Mic is not available","failure"),e(r.x.isMicAvailable))})):(r.x.isMicAvailable=!1,notification("Mic is not available","failure"),e(r.x.isMicAvailable))}getUserMedia(e,t){navigator.mediaDevices.getUserMedia(r.x.Constraints[e]).then((function(e){t(e)})).catch((function(e){console.log(e.name),"NotFoundError"==e.name||"DevicesNotFoundError"==e.name?notification("required track is missing ","","failure"):"NotReadableError"==e.name||"TrackStartError"==e.name?notification("webcam or mic are already in use  ","","failure"):"OverconstrainedError"==e.name||"ConstraintNotSatisfiedError"==e.name?notification("constraints can not be satisfied by avb. devices  ","","failure"):"NotAllowedError"==e.name||"PermissionDeniedError"==e.name?notification("permission denied in browser  ","","failure"):"TypeError"==e.name||"TypeError"==e.name?notification("empty constraints object  ","","failure"):notification("other errors  ","","failure"),t(!1)}))}stopTracks(e){"video"==e?r.x.localMediaVideoStream&&r.x.localMediaVideoStream.getTracks().forEach((function(e){e.stop()})):r.x.localMediaAudioStream&&r.x.localMediaAudioStream.getTracks().forEach((function(e){e.stop()}))}getConnectedMediaDevices(e){navigator.mediaDevices.enumerateDevices().then((t=>{r.x.videoInput=t.filter((e=>"videoinput"===e.kind)),r.x.audioInput=t.filter((e=>"audioinput"===e.kind)),r.x.audioOutput=t.filter((e=>"audiooutput"===e.kind)),r.x.videoInput.length>0?r.x.Constraints.video={video:{width:{max:1920,min:640},height:{max:1080,min:360},aspectRatio:{exact:1.7777777778}}}:r.x.Constraints.video=!1,r.x.audioInput.length>0?r.x.Constraints.audio={audio:!0}:r.x.Constraints.audio=!1,e()}))}toggleMic(e){self=this;let t=r.x.localMediaAudioStream;r.x.isMicAvailable&&null!=t&&t.active&&t.getAudioTracks().length>0?t.getAudioTracks().forEach(((i,r)=>{t.getAudioTracks()[r].enabled=!t.getAudioTracks()[r].enabled,e(t.getAudioTracks()[r].enabled?"Unute":"Mute")})):self.getMic((function(t){if(t){let t=r.x.localMediaAudioStream;r.x.isMicAvailable&&null!=t&&t.active&&t.getAudioTracks().length>0&&t.getAudioTracks().forEach(((i,r)=>{t.getAudioTracks()[r].enabled=!t.getAudioTracks()[r].enabled,e(t.getAudioTracks()[r].enabled?"Unute":"Mute")}))}else e(!1)}))}toggleVideo(e){self=this;let t=r.x.localMediaVideoStream;r.x.isCameraAvailable&&null!=t&&t.active&&t.getVideoTracks().length>0?t.getVideoTracks().forEach(((i,a)=>{t.getVideoTracks()[a].enabled=!t.getVideoTracks()[a].enabled,e(t.getVideoTracks()[a].enabled?"Start cam":"Stop cam");var o=$("#localstream_"+r.x.socketclient.id)[0].nextSibling.firstChild;0==t.getVideoTracks()[a].enabled?($("#localstream_"+r.x.socketclient.id).css("opacity","0"),$("#avatarBg .connectText").hide(),o.classList.remove("user-name"),o.classList.add("toggleUserName","mt-5","pt-5"),$(".video-list .videoWrap").length>0&&$("#localstream_"+r.x.socketclient.id)[0].parentNode.className==$(".video-list .videoWrap")[0].className&&($("#localstream_"+r.x.socketclient.id).addClass("opacity-100"),o.classList.remove("toggleUserName","mt-5","pt-5"))):($("#localstream_"+r.x.socketclient.id).css("opacity",""),o.classList.add("user-name"),o.classList.remove("toggleUserName","mt-5","pt-5"),$("#localstream_"+r.x.socketclient.id).removeClass("opacity-100"))})):this.getCamera((function(t){if(t){let t=r.x.localMediaVideoStream;r.x.isCameraAvailable&&null!=t&&t.active&&t.getVideoTracks().length>0&&t.getVideoTracks().forEach(((i,r)=>{t.getVideoTracks()[r].enabled=!t.getVideoTracks()[r].enabled,e(t.getVideoTracks()[r].enabled?"Start cam":"Stop cam")}))}else e(!1)}))}changeCamera(e){this.stopTracks("video"),this.getCamera((function(t){e(!!t&&r.x.localMediaVideoStream)}))}changeMic(e){this.stopTracks("audio"),this.getMic((function(t){e(!!t&&r.x.localMediaAudioStream)}))}getAudioStream(e){let t,i=e.getAudioTracks();return t=i.length>0?new MediaStream(i):"No Audio",t}getVideoStream(e){let t,i=e.getVideoTracks();return t=i.length>0?new MediaStream(i):"No video",t}getAudioTrack(e){let t=e.getAudioTracks();return t.length>0?t:"No audio"}getVideoTrack(e){let t=e.getVideoTracks();return t.length>0?t:"No video"}addAudioTrack(e,t){t&&(r.x.allAudioTracks.push({id:e,audiotrack:t}),r.x.mainAudioTrack=this.MixallAudioTracks(r.x.allAudioTracks),console.log("ON add Audio track**********************************************************",e,r.x.allAudioTracks),this.dispatchAudioChangeEvent())}removeAudioTrack(e){let t=r.x.allAudioTracks.findIndex((t=>t.id===e));null==t&&-1==t||(r.x.allAudioTracks.splice(t,1),r.x.mainAudioTrack=this.MixallAudioTracks(r.x.allAudioTracks),console.log("ON remove Audio track**********************************************************",e,r.x.allAudioTracks),this.dispatchAudioChangeEvent())}dispatchAudioChangeEvent(){window.dispatchEvent(r.x.AudioMix)}MixallAudioTracks(e){let t=new AudioContext;if(e.length>0){let i=e.map((e=>t.createMediaStreamSource(new MediaStream([e.audiotrack])))),r=t.createMediaStreamDestination();return i.forEach((e=>e.connect(r))),r.stream.getAudioTracks()[0]}return r.x.silenceAudioTrack}silenceAudio=()=>{let e=new AudioContext,t=e.createOscillator(),i=t.connect(e.createMediaStreamDestination());return t.start(),Object.assign(i.stream.getAudioTracks()[0],{enabled:!1})};async setupLocalVideo(e){try{let t=r.x.localMediaVideoStream;t&&(r.x.localVisualMedia?r.x.isadmin?r.x.localVisualMedia.mediabox.realvideo.srcObject=t:r.x.localVisualMedia.srcObject=t:r.x.localVisualMedia=await se.mediawrapper.createMedia(r.x.isadmin,this.VideoSourceType.type1,t,r.x.socketclient.id,r.x.displayname)),e()}catch(e){}}setup_local_media_preview(e,t){$("#"+t)[0].srcObject=e}async setupRemoteVideo(e,t,i){i(await se.mediawrapper.createMedia(e,this.VideoSourceType.type2,t.videomediastream,t.peerid,t.displayname))}async setupRemoteAudio(e,t){await se.mediawrapper.createAudio(e,t)}setupRemoteCanvasVideo(e){let t=document.createElement("VIDEO");t.id="mainvideo",t.style.width="100%",t.setAttribute("autoplay","autoplay"),t.setAttribute("loop","loop"),t.setAttribute("playsinline",""),t.srcObject=e,t.load(),t.play(),$("#Main").empty().append(t)}}let de=new ne,le=new ce;class he{addPeer(e){if(console.log(" My Socket id :",r.x.socketclient.id),e.peerid!=r.x.socketclient.id){let i=e.peerid;if(console.log("Signaling server said to add peer:",i," to Create offer :",e.createoffer),r.x.Peers.find((e=>e.peerid===i)))return void console.log("Already connected to peer ",i);var t=new a._(i);t.isadmin=e.isadmin,t.displayname=e.displayname,r.x.Peers.push(t),t.peer.onicecandidate=e=>{if(e.candidate){let t={peerid:i,type:"candidate",roomname:r.x.conferencename,data:e.candidate};this.sendSDPdescription("senddata",t)}},t.peer.onnegotiationneeded=r=>{console.log("ON NEGOTIATION NEEDED"),e.createoffer&&this.createoffer(t,i)},t.peer.ontrack=e=>{e.streams[0]&&("video"==e.track.kind&&(console.log("VIDEO : :  :  : ",e.track,e.streams[0]),console.log(e.track.getConstraints()),this.setupRemoteVideo(i,e.streams[0])),"audio"==e.track.kind&&(console.log("AUDIO : :  :  : ",e.track,e.streams[0]),this.setupRemoteAudio(i,e.track,e.streams[0])))},r.x.localMediaVideoStream.getVideoTracks().forEach((e=>{t.peer.addTrack(e,r.x.localMediaVideoStream)})),r.x.localMediaAudioStream.getAudioTracks().forEach((e=>{t.peer.addTrack(e,r.x.localMediaAudioStream)}))}}createoffer(e,t){self=this,console.log("Creating RTC offer to ",t),e.peer.createOffer((function(i){e.peer.setLocalDescription(i,(function(){let e={peerid:t,type:"offer",roomname:r.x.conferencename,data:i};self.sendSDPdescription("senddata",e)}),(function(){Alert("Offer setLocalDescription failed!")}))}),(function(e){console.log("Error sending offer: ",e)}))}onOffer(e){let t=e.peerid,i=r.x.Peers.find((e=>e.peerid===t));i.peer.setRemoteDescription(new RTCSessionDescription(e.data)),i.peer.createAnswer().then((e=>{i.peer.setLocalDescription(e);let a={peerid:t,type:"answer",data:e,roomname:r.x.conferencename};this.sendSDPdescription("senddata",a)})).catch()}onAnswer(e){try{let t=e.peerid;r.x.Peers.find((e=>e.peerid===t)).peer.setRemoteDescription(new RTCSessionDescription(e.data))}catch(e){console.error("Error on answer",e)}}onCandidate(e){try{var t=e.peerid;r.x.Peers.find((e=>e.peerid===t)).peer.addIceCandidate(e.data)}catch(e){console.error("Error adding received ice candidate",e)}}async onRemovePeer(e){if(e){let t=r.x.Peers.findIndex((t=>t.peerid===e));if(-1!=t){let i=r.x.Peers[t].peer;await i.close(),this.removeElement("cardvideo_remotestream_"+e),this.removeElement("audio_"+e),le.removeAudioTrack(e),r.x.Peers.splice(t,1),r.x.isadmin&&(de.mediawrapper.HideMedia(e),de.mediawrapper.RemoveMedia(e))}}}removeElement(e){$("#"+e).remove(),this.videoRemoved()}videoRemoved(){if($(".video-list .videoWrap").length>0&&"undefined"!=$(".video-list .videoWrap").attr("style")&&$("#ListVideos .videoWrap").removeAttr("style"),0==$(".mainVideo").length&&$(".video-list .videoWrap").length>0){var e=$("#localstream_"+r.x.socketclient.id);$("#mainVideoBg").each((async function(){$("#mainVideoBg").html(' <div class="mainVideo main-videoWrap"> </div>'),await $("#mainVideoBg .mainVideo").append(e[0].offsetParent),e[0].style.width="100%",$("#mainVideoBg .SupportClass").removeClass("position-relative videoWrap"),$("#mainVideoBg .cardList").removeClass("p-0 p-sm-1"),$("#mainVideoBg .cardList").addClass("main-Card p-0 m-3")}))}}sendSDPdescription(e,t){r.x.socketclient.emit(e,t)}getPeerObjbyPeerId(e){return r.x.Peers.find((t=>t.peerid===e))}AudioTrackEnableDisable(e,t){var i=r.x.Peers.find((t=>t.peerid===e));if(i){i.showonstream=t;let e=i.peer.getReceivers().find((function(e){return"audio"==e.track.kind}));e&&(e.track.enabled=t)}}setupRemoteVideo(e,t){let i=r.x.Peers.find((t=>t.peerid===e));i.videomediastream=t,le.setupRemoteVideo(r.x.isadmin,i,(function(t){i.VisualMedia=t,r.x.isadmin&&de.mediawrapper.ShowMedia(e)}))}setupRemoteAudio(e,t,i){r.x.Peers.find((t=>t.peerid===e)).audiomediastream=i,le.setupRemoteAudio(e,i),t&&r.x.isadmin&&le.addAudioTrack(e,t)}getRemotePeerAudioTrack(e){let t=this.getPeerObjbyPeerId(e);return!!t.audiomediastream&&t.audiomediastream.getAudioTracks()[0]}getRemotePeerVideoTrack(e){let t=this.getPeerObjbyPeerId(e);return!!t.videomediastream&&t.videomediastream.getVideoTracks()[0]}ShowOrHideStream(e,t,i){let a;switch(t){case"remotestream":a=this.getRemotePeerAudioTrack(i);break;case"localstream":r.x.localMediaAudioStream&&(a=r.x.localMediaAudioStream.getAudioTracks()[0])}a&&le.addAudioTrack(i,a);let o={};return o.showonstream=e,o.id=i,o.conferencename=r.x.conferencename,r.x.socketclient.emit("sendAudio",o),o}FlipMedia(e){de.mediawrapper.FlipMedia(e)}toggleAudio(e){let t=this.getPeerObjbyPeerId(e);if(t){let e=t.peer.getReceivers().find((function(e){return"audio"==e.track.kind}));return!!e&&e.track.enabled}return!1}toggleVideo(e){let t=this.getPeerObjbyPeerId(e);if(t){let e=t.peer.getReceivers().find((function(e){return"video"==e.track.kind}));return!!e&&(e.track.enabled=!e.track.enabled,e.track.enabled)}return!1}replaceVideoTrack(){let e=r.x.localMediaVideoStream.getVideoTracks()[0];r.x.Peers.forEach((function(t){let i=t.peer.getSenders().find((function(t){return t.track.kind==e.kind}));console.log("found sender:",i),i.replaceTrack(e)}))}replaceAudioTrack(){let e=r.x.localMediaAudioStream.getAudioTracks()[0];r.x.Peers.forEach((function(t){let i=t.peer.getSenders().find((function(t){return t.track.kind==e.kind}));console.log("found sender:",i),i.replaceTrack(e)}))}}var ue=i(94);let pe=new he;class me{initializeSocketEvents(e){self=this,r.x.socketclient=io(),r.x.socketclient.on("connect",(function(){console.log("Connected to signaling server"),e("Connected")})),r.x.socketclient.on("addPeer",(function(e){pe.addPeer(e)})),r.x.socketclient.on("message",(function(e){switch(e.type){case"offer":pe.onOffer(e);break;case"answer":pe.onAnswer(e);break;case"candidate":pe.onCandidate(e)}})),r.x.socketclient.on("removePeer",(function(e){pe.onRemovePeer(e)})),r.x.socketclient.on("receiveAudio",(function(e){pe.AudioTrackEnableDisable(e.id,e.showonstream)})),r.x.socketclient.on("receiveChat",(function(e){!function(e){console.log("Type",e);var t=document.createElement("li");notification("Message from "+e.username),$("#chatNotification").removeClass("d-none"),t.innerHTML=`<div class="d-flex flex-row justify-content-start mb-4">'\n        <div class="p-2" style="border-radius: 15px;background-color: rgba(57, 192, 237,.2);">\n          <p class="small mb-0"><b>${e.username}</b> : ${e.text}</p>\n          <p class="small ms-3 mb-3 rounded-3 text-muted">${$.format.date(new Date,"h:mm a")}</p>\n        </div>\n      </div>`,messages.appendChild(t)}(e)})),r.x.socketclient.on("acceptordecline",(function(e){var t;r.x.isadmin&&(t=e,ge.innerHTML="",t.length>0?t.forEach((function(e){e.conferencename==r.x.conferencename&&($("#participantsNotification").removeClass("d-none"),notification("Join request from "+e.displayname,"success"),$(document).ready((function(){$("#modalParticipants").modal("show"),$("#participantsNotification").show(),$(".modal-backdrop").show()})),$("#modalParticipants").on("click",(function(){$("#modalParticipants").modal("toggle")})),ge.innerHTML+="<div class=''><span class='m-1 text-center col-3'>"+e.displayname+"</span><button id='accept' type='button' class='col-4 btn btn-success  col-2' onclick='acceptUser(this,"+JSON.stringify(e)+");'>Accept</button> <button id='reject' type='button' class='btn btn-danger  col-4' onclick='rejectUser(this,"+JSON.stringify(e)+");'>Reject</button></div>")})):ge.innerHTML='<div class="text-center">No users</div>')})),r.x.socketclient.on("Accepted",(function(e){document.getElementById("load").style.display="none",document.getElementById("Main").style.display="block",r.x.socketclient.emit("joinConference",e)})),r.x.socketclient.on("sendrequestresponse",(function(e){e.forEach((function(e){if(e.conferencename===r.x.conferencename){var t='<div class="mb-2  "><span class="avatar avatar-24 bg-danger text-white  rounded-circle  m-2 ">'+e.displayname.substring(0,1)+'</span><span class="">'+e.displayname+" </span></div>";$("#listdisplayname").append(t)}}))})),r.x.socketclient.on("Rejected",(function(e){document.getElementById("load").innerHTML="Sorry, Admin rejected your request"})),r.x.socketclient.on("onremoveguestuser",(function(e){location.replace(window.location.href.split("?")[0]+"conferenceended.html")})),r.x.socketclient.on("ontoggleAudio",(function(){$("#idAudio").click()})),r.x.socketclient.on("ontoggleVideo",(function(){$("#idVideo").click()})),r.x.socketclient.on("toggleFlipres",(function(e){console.log("flip data",e);let t=document.getElementById("remotestream_"+e.peerid);t&&(t.classList.toggle("mirroron"),r.x.isadmin&&pe.FlipMedia(e.peerid))})),r.x.socketclient.on("muteallres",(function(){if(!r.x.isadmin){let e=r.x.localMediaAudioStream;null!=e&&e.getAudioTracks().length>0&&e.getAudioTracks().forEach(((t,i)=>{e.getAudioTracks()[i].enabled&&(notification("Admin muted your mic","info"),$("#idAudio").click())}))}})),r.x.socketclient.on("removeAcceptedUserEvent",(function(e){0!=$("#accept").length&&$("#accept")[0].parentNode.remove(),0==$("#acceptdeclineid").children().length&&(ge.innerHTML='<div class="text-center">No users</div>')})),r.x.socketclient.on("removeRejectedUsersEvent",(function(e){0!=$("#reject").length&&$("#reject")[0].parentNode.remove(),0==$("#acceptdeclineid").children().length&&(ge.innerHTML='<div class="text-center">No users</div>')})),r.x.socketclient.on("StratStreaming",(function(e){console.log("startStreaming"),(0,ue.N)()})),r.x.socketclient.on("RestartRecording",(function(e){console.log("Restart Streaming",e),(0,ue.N)()})),r.x.socketclient.on("RemoveRecordText",(function(){$("#conferencetimer").removeClass("recordblink"),$("#conferencetimer").removeClass("RecordTextAdding"),$("#recordingText").remove()})),r.x.socketclient.on("AddingRecoingTextForUser",(function(){setTimeout((()=>{$("#conferencetimer").addClass("recordblink"),$("#conferencetimer").addClass("RecordTextAdding"),$("#clockdiv .RecordText").html('<p id="recordingText" style=" color: #3D224D; font-size: 12px; font-weight:bold;">Recording</p>')}),6e3)})),navigator.userAgent.match(/Android|iPhone|iPad|iPod/i)&&r.x.socketclient.on("endConferenceforeveryoneres",(function(){location.replace(window.location.href.split("?")[0]+"conferenceended.html")}))}socketEmit(e,t){r.x.socketclient.emit(e,t)}}const ge=document.getElementById("acceptdeclineid");window.acceptUser=(e,t)=>{console.log(t),r.x.socketclient.emit("userAccepted",t)},window.rejectUser=(e,t)=>{console.log(t),r.x.socketclient.emit("userRejected",t)};let fe=new class{Studio=new ne;InitStudio(e){this.Studio.CreateStudio(e)}};class ve{objSocketManager=new me;objMediaCapture=new ce;objPeerManager=new he;joinConference(e,t){let i=this;i.objSocketManager.initializeSocketEvents((function(a){i.setGlobalVariables(e),i.objMediaCapture.initializeCamera((function(a){e.isadmin&&fe.InitStudio("scene1"),i.objMediaCapture.setupLocalVideo((function(){e.isadmin?(e.recording&&(e.channelLink=window.location.href.split("?")[0]+"recordedvideos/"+e.conferencename+"/"),i.objSocketManager.socketEmit("joinConference",e),r.x.localMediaAudioStream?i.objMediaCapture.addAudioTrack(r.x.socketclient.id,r.x.localMediaAudioStream.getAudioTracks()[0]):(i.setSilenceAudioTrack(),i.objMediaCapture.addAudioTrack(r.x.socketclient.id,r.x.silenceAudioTrack)),fe.Studio.mediawrapper.ShowMedia(r.x.socketclient.id)):i.objSocketManager.socketEmit("sendrequest",e),t()}))}))}))}leaveConference(e){this.objSocketManager.socketEmit("leaveConference",e)}setGlobalVariables(e){r.x.conferencename=e.conferencename,r.x.userid=e.userid,r.x.isadmin=e.isadmin,r.x.displayname=e.displayname.charAt(0).toUpperCase()+e.displayname.slice(1)}setSilenceAudioTrack(){r.x.silenceAudioTrack=this.objMediaCapture.silenceAudio()}}}},i={};function r(e){var a=i[e];if(void 0!==a)return a.exports;var o=i[e]={exports:{}};return t[e](o,o.exports,r),o.exports}r.amdO={},r.d=(e,t)=>{for(var i in t)r.o(t,i)&&!r.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";var e=r(112),t=r(593),i=r(94);let a=new t.E;function o(){let t=getDataFromLocalStorage();console.log(t),t?(t.isadmin?(document.getElementById("Main").style.display="block",document.getElementById("Waiting").style.display="block",document.getElementById("muteall").style.display="inline-block",document.getElementById("muteall_1").style.display="inline-block",document.getElementById("muteall_2").style.display="inline-block",document.getElementById("idParticipants").style.display="inline-block"):document.getElementById("load").style.display="block",(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/iPhone|iPad|iPod/i)||navigator.userAgent.match(/IEMobile/i))&&(document.getElementById("idSettings").style.display="none",document.getElementById("switchcamera").style.display="inline-block"),a.joinConference(t,(function(){null!=e.x.localMediaVideoStream&&e.x.localMediaVideoStream.getVideoTracks().length>0&&e.x.localMediaVideoStream.getVideoTracks().forEach(((t,i)=>{let r=e.x.localMediaVideoStream.getVideoTracks()[i].enabled?"Start cam":"Srop cam",a=document.getElementById("idVideo");"Stop cam"==r?(a.classList.remove("bi-camera-video-fill"),a.classList.add("bi-camera-video-off-fill")):(a.classList.remove("bi-camera-video-off-fill"),a.classList.add("bi-camera-video-fill"))})),null!=e.x.localMediaAudioStream&&e.x.localMediaAudioStream.getAudioTracks().length>0&&e.x.localMediaAudioStream.getAudioTracks().forEach(((t,i)=>{e.x.localMediaAudioStream.getAudioTracks()[i].enabled=!1;let r=e.x.localMediaAudioStream.getAudioTracks()[i].enabled?"Unmute":"Mute",a=document.getElementById("idAudio");"Mute"==r?(a.classList.remove("bi-mic-fill"),a.classList.add("bi-mic-mute-fill")):(a.classList.remove("bi-mic-mute-fill"),a.classList.add("bi-mic-fill"))})),function(t){var r=$("#videoinput");if(r.on("change",s),e.x.videoInput.length>0&&$.each(e.x.videoInput,(function(e,t){r.append('<option value="'+e+'">'+t.label+"</option>")})),e.x.audioInput.length>0){var a=$("#audioinput");a.on("change",s),$.each(e.x.audioInput,(function(e,t){a.append('<option value="'+e+'">'+t.label+"</option>")}))}if(e.x.audioOutput.length>0){var o=$("#audiooutput");$.each(e.x.audioOutput,(function(e,t){o.append('<option value="'+e+'">'+t.label+"</option>")}))}document.getElementById("idEndCall").addEventListener("click",(function(){(0,i.T)()}))}()}))):notification("Invalid data","failure")}$(window).on("load",(function(){!function(e){let t={};t=getDataFromQueryString(),t?o():notification("Please check the query string data","failure")}()}));var n="user";function s(t){"audioinput"==t.target.id&&(e.x.Constraints.audio={audio:{deviceId:{exact:e.x.audioInput[t.target.selectedIndex].deviceId}}},a.objMediaCapture.changeMic((function(e){a.objPeerManager.replaceAudioTrack()}))),"videoinput"==t.target.id&&(e.x.Constraints.video={video:{deviceId:{exact:e.x.videoInput[t.target.selectedIndex].deviceId},aspectRatio:{exact:1.7777777778}}},c())}function c(){a.objMediaCapture.changeCamera((function(t){if(t){let i=document.getElementById("localstream_"+e.x.socketclient.id);i&&(i.srcObject=t),a.objPeerManager.replaceVideoTrack()}}))}document.querySelector("#switchcamera").addEventListener("click",(function(){n="user"==n?"environment":"user",e.x.Constraints.video={video:{facingMode:n,width:{max:1920,min:640},height:{max:1080,min:360},aspectRatio:{exact:1.7777777778}}},c()}),!1),$("#idParticipants").click((function(){$("#participantsNotification").addClass("d-none")})),$("#modalParticipants").on("hidden.bs.modal",(function(){$("#participantsNotification").addClass("d-none")})),$("#idChat").click((function(){$("#chatNotification").addClass("d-none")})),$("#modalChat").on("hidden.bs.modal",(function(){$("#chatNotification").addClass("d-none")}))})(),(()=>{"use strict";var e=r(112),t=r(593);r(94);let i=new t.E;e.x.socketclient=io(),window.removeguestuser=(e,t)=>{let r={peerid:t};i.objSocketManager.socketEmit("removeguestuser",r)},window.toggleAudio=(e,t)=>{'<a class="dropdown-item" href="#"><i class="bi bi-mic-mute m-1"></i>Stop Audio</a>'==e.innerHTML?e.innerHTML='<a class="dropdown-item" href="#"><i class="bi bi-mic m-1"></i>Start Audio</a>':e.innerHTML='<a class="dropdown-item" href="#"><i class="bi bi-mic-mute m-1"></i>Stop Audio</a>',i.objPeerManager.toggleAudio(t);let r={peerid:t};i.objSocketManager.socketEmit("toggleaudio",r)},window.toggleVideo=(e,t)=>{'<a class="dropdown-item" href="#"><i class="bi bi-camera-video-off m-1"></i>Stop Video</a>'==e.innerHTML?e.innerHTML='<a class="dropdown-item" href="#"><i class="bi bi-camera-video m-1"></i>Start Video</a>':e.innerHTML='<a class="dropdown-item" href="#"><i class="bi bi-camera-video-off m-1"></i>Stop Video</a>',i.objPeerManager.toggleVideo(t);let r={peerid:t};i.objSocketManager.socketEmit("togglevideo",r)},window.toggleFlip=(t,r)=>{let a=document.getElementById("localstream_"+r),o=document.getElementById("preview");if(a){a.classList.toggle("mirroron"),o.classList.toggle("mirroron"),e.x.isadmin&&i.objPeerManager.FlipMedia(r);let t={conferencename:e.x.conferencename,peerid:r};i.objSocketManager.socketEmit("toggleFlip",t)}},$("#idAudio").click((function(e){i.objMediaCapture.toggleMic((function(t){0!=t&&("Mute"==t?(e.target.classList.remove("bi-mic-fill"),e.target.classList.add("bi-mic-mute-fill")):(e.target.classList.remove("bi-mic-mute-fill"),e.target.classList.add("bi-mic-fill")))}))})),$("#idVideo").click((function(e){i.objMediaCapture.toggleVideo((function(t){0!=t&&("Stop cam"==t?(e.target.classList.remove("bi-camera-video-fill"),e.target.classList.add("bi-camera-video-off-fill")):(e.target.classList.remove("bi-camera-video-off-fill"),e.target.classList.add("bi-camera-video-fill")))}))})),$("#idEndCall").click((function(t){var r=e.x.getdata();r.peerid=e.x.socketclient.id,i.objSocketManager.socketEmit("endConferenceEvent",r),(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/iPhone|iPad|iPod/i)||navigator.userAgent.match(/IEMobile/i))&&(e.x.isadmin?i.objSocketManager.socketEmit("endConferenceforeveryone",e.x.getdata()):location.href="conferenceended.html")})),$("#muteall").click((function(t){i.objSocketManager.socketEmit("muteall",e.x.getdata()),notification("All users have been muted","success")}))})(),(()=>{"use strict";var e=r(112);const t=[];var i=document.getElementById("input");function a(){i.value&&(t.push({text:i.value,time:$.format.date(new Date,"h:mm a"),username:e.x.displayname}),function(e){console.log("Type0",e);var t=document.createElement("li");e.forEach((e=>{t.innerHTML=`<div class="d-flex flex-row justify-content-end mb-4">'\n    <div class="p-2" style="border-radius: 15px;background-color: #d4d9e3">\n      <p class="small mb-0"><b>${e.username}</b> : ${e.text}</p>\n      <p class="small ms-3 mb-3 rounded-3 text-muted">${$.format.date(new Date,"h:mm a")}</p>\n    </div>\n  </div>`,messages.appendChild(t)}))}(t),i.value&&(e.x.socketclient.emit("sendChat",e.x.getdata(),i.value),i.value=""))}i.addEventListener("keypress",(function(e){"Enter"===e.key&&a()})),$("#sendmessage").click((function(e){a()}))})(),(()=>{"use strict";var e=r(112);let t=new(r(593).E);$(window).on("load",(function(){var i=0,r=0;function a(e){const t=Date.parse(e)-Date.parse(new Date);return{total:t,minutes:Math.floor(t/1e3/60%60),seconds:Math.floor(t/1e3%60)}}function o(i,r,o){document.getElementById("conferencetimer").style.boxShadow="inset 2px 2px 2px 0px rgba(255, 255, 255, .5), 7px 7px 20px 0px rgba(0, 0, 0, .1),4px 4px 5px 0px rgba(0, 0, 0, .1)",document.getElementById("timeColon").style.display="inline-block";const s=document.getElementById(i),c=s.querySelector(".minutes"),d=s.querySelector(".seconds"),l=setInterval((function(){const e=a(r);c.innerHTML=("0"+e.minutes).slice(-2),d.innerHTML=("0"+e.seconds).slice(-2),0==e.total&&new Promise((function(e,t){e(void(h||(h=!0,clearInterval(l))))})).then((function(){return setTimeout((()=>{return e=c,t=d,i=o,void setInterval((function(){++i,t.innerHTML=n(i%60),e.innerHTML=n(parseInt(i/60))}),1e3);var e,t,i}),500)}))}),1e3);e.x.socketclient.on("CountofJoinedUsers",(function(e){if(r){let h=c.innerText+":"+d.innerText;e.IntialUsersStartedTime=(n=~~((i=o)%3600/60),l="",(a=~~(i/3600))>0&&(l+=a+":"+(n<10?"0":"")),(l+=n+":"+((s=~~i%60)<10?"0":""))+s),e.currentTime=h,e.endtime=r,t.objSocketManager.socketEmit("JoinedUsersTime",e)}var i,a,n,s,l})),e.x.socketclient.on("GetReminigTime",(function(e){let i=c.innerText+":"+d.innerText;e.currentTime=i,e.endtime=r,t.objSocketManager.socketEmit("RunningTime",e)})),document.getElementById("idEndCall").addEventListener("click",(function(){if(!h){h=!0,clearInterval(l);const n=a(r);var i=n.minutes+":"+n.seconds;if(i){var o=e.x.getdata();o.UserLeftTime=i,t.objSocketManager.socketEmit("UserLeftTime",o)}}}),!1);var h=!1;""!=$("#recordingText")&&$("#clockdiv").css("line-height","1.2")}function n(e){var t=e+"";return t.length<2?"0"+t:t}document.getElementById("timeColon").style.display="none",e.x.socketclient.on("RecordingText",(function(e){setTimeout((()=>{$("#conferencetimer").addClass("recordblink"),$("#conferencetimer").addClass("RecordTextAdding"),$("#clockdiv .RecordText").html('<p id="recordingText" style="color: #3D224D; font-size: 12px;  font-weight: bold;">Recording</p>')}),5e3)})),e.x.socketclient.on("StartTime",(function(e,t){var i=e/60;const r=new Date(Date.parse(new Date)+60*i*1e3);localStorage.setItem("starttime",r),o("clockdiv",localStorage.getItem("starttime"),e)})),e.x.socketclient.on("setJoinedUsersTime",(function(e){var t=e.currentTime.split(":").reduce(((e,t)=>60*e+ +t))/60,r=e.IntialUsersStartedTime.split(":").reduce(((e,t)=>60*e+ +t));1==(i+=1)&&o("clockdiv",new Date(Date.parse(new Date)+60*t*1e3),r)})),e.x.socketclient.on("setReminingTime",(function(e){var t=e.currentTime.split(":").reduce(((e,t)=>60*e+ +t))/60,i=e.IntialStartedTime.split(":").reduce(((e,t)=>60*e+ +t));1==(r+=1)&&o("clockdiv",new Date(Date.parse(new Date)+60*t*1e3),i)}))}))})(),(()=>{function e(){const e=navigator.userAgent;/(tablet|ipad|playbook|silk)|(android(?!.*mobi))/i.test(e)&&window.innerHeight>window.innerWidth?($("#MediaStream").removeAttr("style"),$("#MediaStream ").addClass("pb-5"),$(".mainVideo video").css({height:"100%"}),$(".video-list .SupportClass").removeClass("m-2"),$(".video-list video").css({width:"258px",height:"10rem"}),$(".cardList .user-name").css("font-size",""),$(".video-list #DropDown").addClass("mx-3 p-2"),$(".footer").removeClass("m-4"),window.matchMedia("only screen and (min-width: 1024px) and (min-height: 1366px) and (orientation: portrait)").matches&&($("#MediaStream").removeClass("offset-lg-9 col-lg-2  text-lg-end"),$("#MediaStream ").removeAttr("style"),$(".mainVideo video").css({height:"100%"}),$(".mainVideo video").css("object-fit","cover"),$(".video-list video").css({width:"251px",height:"10rem"}),$(".video-list .SupportClass").removeClass("m-2"),$(".cardList .user-name").css("font-size",""),$(".video-list #DropDown").addClass("mx-3 p-2"),$(".footer").removeClass("m-4"))):/Mobile|Android|iP(hone|od)|IEMobile|BlackBerry|Kindle|Silk-Accelerated|(hpw|web)OS|Opera M(obi|ini)/.test(e)&&window.innerHeight>window.innerWidth?($(".mainVideo video").css({height:"100%"}),$(".mainVideo video").css("object-fit","cover"),$(".cardList .user-name").css("font-size","9px"),$("#MediaStream").removeAttr("style"),$("#MediaStream ").addClass("pb-5"),$(".video-list video").css({width:"124px",height:"5rem"}),$(".video-list .SupportClass").removeClass("m-2"),$(".video-list #DropDown").removeClass("mx-3 p-2"),$(".footer").removeClass("m-4")):/(tablet|ipad|playbook|silk)|(android(?!.*mobi))/i.test(e)&&window.innerHeight<window.innerWidth?($("#MediaStream").removeAttr("style"),$(".mainVideo video").css({height:"100%"}),$(".mainVideo video").css("object-fit","cover"),$(".video-list video").css({width:"250px",height:"auto"}),$(".cardList .user-name").css("font-size",""),$(".video-list #DropDown").addClass("mx-3 p-2"),$(".footer").addClass("m-4"),$("#MediaStream").css("margin-left","75%"),window.matchMedia("only screen and (min-width: 1366px) and (min-height: 1024px) and (orientation: landscape)").matches&&($(".video-list #DropDown").addClass("mx-3 p-2"),$("#MediaStream").addClass("offset-lg-9 col-lg-2  text-lg-end"),$("#MediaStream").css("margin-left","77%"),$(".video-list video").css({width:"251px",height:"auto"}),$(".cardList .user-name").css("font-size",""),$(".footer").addClass("m-4"))):/Mobile|Android|iP(hone|od)|IEMobile|BlackBerry|Kindle|Silk-Accelerated|(hpw|web)OS|Opera M(obi|ini)/.test(e)&&window.innerHeight<window.innerWidth?($(".video-list").addClass("mb-4"),$(".mainVideo video").css({height:"100%"}),$(".mainVideo video").css("object-fit","cover"),$("#MediaStream").removeAttr("style"),$("#MediaStream").removeClass("pb-5"),$(".video-list video").css({width:"145px",height:"auto"}),$(".cardList .user-name").css("font-size","11px"),$(".footer").removeClass("m-4")):window.innerHeight<window.innerWidth&&($(".cardList .user-name").css("font-size",""),$("#MediaStream").removeAttr("style"),$("#MediaStream").addClass(" offset-lg-9 col-lg-2  text-lg-end mb-3"),$("#MediaStream .video-list").removeAttr("style"),$(".mainVideo video").css({height:"100%"}),$(".video-list video").css({height:"auto"}),$(".video-list video").removeAttr("style"),$(".footer").removeClass("m-4"),$(".video-list #DropDown").removeClass("mx-3 p-2"))}$(window).resize((function(){e()})),$("#VisualMedia").on("DOMSubtreeModified",(function(){e()})),$(window).on("orientationchange",(function(e){console.log("orientationChanges"),"undefined"!=$("#ListVideos .videoWrap").attr("style")&&$("#ListVideos .videoWrap").removeAttr("style")}))})(),e=(e,t,i)=>{if($(".video-list .videoWrap").length>0&&$(".mainVideo").length>0){var r=t.find(".videoWrap").prevObject,a=$(".main-videoWrap"),o=t.find(".videoWrap").prevObject[0].id,n=$(".main-videoWrap")[0].id;a.attr("id")!==o?a.attr("id",o):a.attr("id",n),r.attr("id")!==n?r.attr("id",n):r.attr("id",o);var s=t.find("span")[0],c=$(".main-videoWrap").find("span")[0],d=t.find("button")[0],l=$(".main-videoWrap").find("button")[0],h=t.find("ul")[0],u=$(".main-videoWrap").find("ul")[0];!async function(e,t,i,r,a,o,n,s,c,d){var l=e.parentNode,h=e.nextSibling===t?e:e.nextSibling;await t.parentNode.insertBefore(e,t),await l.insertBefore(t,h);const u=getComputedStyle(e).width;e.removeAttribute("style"),t.style.width=u,t.style.opacity="";var p=i.parentNode,m=i.nextSibling===r?i:i.nextSibling;if(await r.parentNode.insertBefore(i,r),await p.insertBefore(r,m),r.classList.remove("mt-5","pt-5"),n.isadmin){var g=a.parentNode,f=a.nextSibling===o?a:a.nextSibling;await o.parentNode.insertBefore(a,o),await g.insertBefore(o,f);var v=s.parentNode,y=s.nextSibling===c?s:s.nextSibling;await c.parentNode.insertBefore(s,c),await v.insertBefore(c,y)}}(t.find("video")[0],$(".main-videoWrap").find("video")[0],s,c,d,l,i,h,u)}},$(document).on("click",".video-list .videoWrap",(function(t){var i=getDataFromQueryString();i.isadmin&&($(this).find("#DropDown")[0].addEventListener("click",(e=>{e.stopImmediatePropagation()})),$(this).find("button")[0].addEventListener("click",(e=>{e.stopImmediatePropagation()}))),e(0,$(this),i)}))})();